/*
 choices.js v11.0.0-rc8 | ? 2024 Josh Johnson | https://github.com/jshjohnson/Choices#readme */
(function(E,y){"object"===typeof exports&&"undefined"!==typeof module?module.exports=y():"function"===typeof define&&define.amd?define(y):(E="undefined"!==typeof globalThis?globalThis:E||self,E.Choices=y())})(this,function(){function E(c,a){function b(){this.constructor=c}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");K(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}function y(c,a,b){if(b||2===arguments.length)for(var d=
0,e=a.length,f;d<e;d++)!f&&d in a||(f||=Array.prototype.slice.call(a,0,d),f[d]=a[d]);return c.concat(f||Array.prototype.slice.call(a))}var K=function(c,a){K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,d){b.__proto__=d}||function(b,d){for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])};return K(c,a)},u=function(){u=Object.assign||function(c){for(var a,b=1,d=arguments.length;b<d;b++){a=arguments[b];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=
a[e])}return c};return u.apply(this,arguments)};"function"===typeof SuppressedError?SuppressedError:function(c,a,b){b=Error(b);return b.name="SuppressedError",b.error=c,b.suppressed=a,b};var W=["fuseOptions","classNames"],N=function(c){return Array.from({length:c},function(){return Math.floor(36*Math.random()).toString(36)}).join("")},X=function(c,a){c=c.id||c.name&&"".concat(c.name,"-").concat(N(2))||N(4);c=c.replace(/(:|\.|\[|\]|,)/g,"");return c="".concat(a,"-").concat(c)},I=function(c){if("string"!==
typeof c){if(null===c||void 0===c)return"";if("object"===typeof c){if("raw"in c)return I(c.raw);if("trusted"in c)return c.trusted}return c}return c.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},Y=function(){var c=document.createElement("div");return function(a){c.innerHTML=a.trim();for(a=c.children[0];c.firstChild;)c.removeChild(c.firstChild);return a}}(),G=function(c,a){return"function"===typeof c?c(I(a),a):c},O=function(c){return"function"===
typeof c?c():c},B=function(c){if("string"===typeof c)return c;if("object"===typeof c){if("trusted"in c)return c.trusted;if("raw"in c)return c.raw}return""},Z=function(c){if("string"===typeof c)return c;if("object"===typeof c){if("escaped"in c)return c.escaped;if("trusted"in c)return c.trusted}return""},v=function(c,a){return c?Z(a):I(a)},aa=function(c,a){return c.rank-a.rank},ba=function(c,a){c=Object.keys(c).sort();var b=Object.keys(a).sort();return c.filter(function(d){return 0>b.indexOf(d)})},
l=function(c){return Array.isArray(c)?c:[c]},J=function(c){return c&&Array.isArray(c)?c.map(function(a){return".".concat(a)}).join(""):".".concat(c)},ca=function(){function c(a){var b=a.type,d=a.classNames;this.element=a.element;this.classNames=d;this.type=b;this.isActive=!1}Object.defineProperty(c.prototype,"distanceFromTopWindow",{get:function(){return this.element.getBoundingClientRect().bottom},enumerable:!1,configurable:!0});c.prototype.show=function(){var a;(a=this.element.classList).add.apply(a,
l(this.classNames.activeState));this.element.setAttribute("aria-expanded","true");this.isActive=!0;return this};c.prototype.hide=function(){var a;(a=this.element.classList).remove.apply(a,l(this.classNames.activeState));this.element.setAttribute("aria-expanded","false");this.isActive=!1;return this};return c}(),P=function(){function c(a){var b=a.type,d=a.classNames,e=a.position;this.element=a.element;this.classNames=d;this.type=b;this.position=e;this.isLoading=this.isDisabled=this.isFlipped=this.isOpen=
!1}c.prototype.shouldFlip=function(a){var b=!1;"auto"===this.position?b=!window.matchMedia("(min-height: ".concat(a+1,"px)")).matches:"top"===this.position&&(b=!0);return b};c.prototype.setActiveDescendant=function(a){this.element.setAttribute("aria-activedescendant",a)};c.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")};c.prototype.open=function(a){var b,d;(b=this.element.classList).add.apply(b,l(this.classNames.openState));this.element.setAttribute("aria-expanded",
"true");this.isOpen=!0;this.shouldFlip(a)&&((d=this.element.classList).add.apply(d,l(this.classNames.flippedState)),this.isFlipped=!0)};c.prototype.close=function(){var a,b;(a=this.element.classList).remove.apply(a,l(this.classNames.openState));this.element.setAttribute("aria-expanded","false");this.removeActiveDescendant();this.isOpen=!1;this.isFlipped&&((b=this.element.classList).remove.apply(b,l(this.classNames.flippedState)),this.isFlipped=!1)};c.prototype.addFocusState=function(){var a;(a=this.element.classList).add.apply(a,
l(this.classNames.focusState))};c.prototype.removeFocusState=function(){var a;(a=this.element.classList).remove.apply(a,l(this.classNames.focusState))};c.prototype.enable=function(){var a;(a=this.element.classList).remove.apply(a,l(this.classNames.disabledState));this.element.removeAttribute("aria-disabled");"select-one"===this.type&&this.element.setAttribute("tabindex","0");this.isDisabled=!1};c.prototype.disable=function(){var a;(a=this.element.classList).add.apply(a,l(this.classNames.disabledState));
this.element.setAttribute("aria-disabled","true");"select-one"===this.type&&this.element.setAttribute("tabindex","-1");this.isDisabled=!0};c.prototype.wrap=function(a){var b=a.parentNode;b&&(a.nextSibling?b.insertBefore(this.element,a.nextSibling):b.appendChild(this.element));this.element.appendChild(a)};c.prototype.unwrap=function(a){var b=this.element.parentNode;b&&(b.insertBefore(a,this.element),b.removeChild(this.element))};c.prototype.addLoadingState=function(){var a;(a=this.element.classList).add.apply(a,
l(this.classNames.loadingState));this.element.setAttribute("aria-busy","true");this.isLoading=!0};c.prototype.removeLoadingState=function(){var a;(a=this.element.classList).remove.apply(a,l(this.classNames.loadingState));this.element.removeAttribute("aria-busy");this.isLoading=!1};return c}(),da=function(){function c(a){var b=a.element,d=a.type,e=a.classNames;a=a.preventPaste;this.element=b;this.type=d;this.classNames=e;this.preventPaste=a;this.isFocussed=this.element.isEqualNode(document.activeElement);
this.isDisabled=b.disabled;this._onPaste=this._onPaste.bind(this);this._onInput=this._onInput.bind(this);this._onFocus=this._onFocus.bind(this);this._onBlur=this._onBlur.bind(this)}Object.defineProperty(c.prototype,"placeholder",{set:function(a){this.element.placeholder=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"value",{get:function(){return this.element.value},set:function(a){this.element.value=a},enumerable:!1,configurable:!0});c.prototype.addEventListeners=function(){var a=
this.element;a.addEventListener("paste",this._onPaste);a.addEventListener("input",this._onInput,{passive:!0});a.addEventListener("focus",this._onFocus,{passive:!0});a.addEventListener("blur",this._onBlur,{passive:!0})};c.prototype.removeEventListeners=function(){var a=this.element;a.removeEventListener("input",this._onInput);a.removeEventListener("paste",this._onPaste);a.removeEventListener("focus",this._onFocus);a.removeEventListener("blur",this._onBlur)};c.prototype.enable=function(){this.element.removeAttribute("disabled");
this.isDisabled=!1};c.prototype.disable=function(){this.element.setAttribute("disabled","");this.isDisabled=!0};c.prototype.focus=function(){this.isFocussed||this.element.focus()};c.prototype.blur=function(){this.isFocussed&&this.element.blur()};c.prototype.clear=function(a){void 0===a&&(a=!0);this.element.value="";a&&this.setWidth();return this};c.prototype.setWidth=function(){var a=this.element,b=a.style,d=a.value;b.minWidth="".concat(a.placeholder.length+1,"ch");b.width="".concat(d.length+1,"ch")};
c.prototype.setActiveDescendant=function(a){this.element.setAttribute("aria-activedescendant",a)};c.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")};c.prototype._onInput=function(){"select-one"!==this.type&&this.setWidth()};c.prototype._onPaste=function(a){this.preventPaste&&a.preventDefault()};c.prototype._onFocus=function(){this.isFocussed=!0};c.prototype._onBlur=function(){this.isFocussed=!1};return c}(),Q=function(){function c(a){this.element=
a.element;this.scrollPos=this.element.scrollTop;this.height=this.element.offsetHeight}c.prototype.clear=function(){this.element.innerHTML=""};c.prototype.prepend=function(a){var b=this.element.firstElementChild;b?this.element.insertBefore(a,b):this.element.append(a)};c.prototype.scrollToTop=function(){this.element.scrollTop=0};c.prototype.scrollToChildElement=function(a,b){var d=this;if(a){var e=this.element.scrollTop+this.element.offsetHeight,f=a.offsetTop+a.offsetHeight,g=0<b?this.element.scrollTop+
f-e:a.offsetTop;requestAnimationFrame(function(){d._animateScroll(g,b)})}};c.prototype._scrollDown=function(a,b,d){b=(d-a)/b;this.element.scrollTop=a+(1<b?b:1)};c.prototype._scrollUp=function(a,b,d){b=(a-d)/b;this.element.scrollTop=a-(1<b?b:1)};c.prototype._animateScroll=function(a,b){var d=this,e=this.element.scrollTop,f=!1;0<b?(this._scrollDown(e,4,a),e<a&&(f=!0)):(this._scrollUp(e,4,a),e>a&&(f=!0));f&&requestAnimationFrame(function(){d._animateScroll(a,b)})};return c}(),R=function(){function c(a){var b=
a.classNames;this.element=a.element;this.classNames=b;this.isDisabled=!1}Object.defineProperty(c.prototype,"isActive",{get:function(){return"active"===this.element.dataset.choice},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"value",{get:function(){return this.element.value},set:function(a){this.element.setAttribute("value",a);this.element.value=a},enumerable:!1,configurable:!0});
c.prototype.conceal=function(){var a,b=this.element;(a=b.classList).add.apply(a,l(this.classNames.input));b.hidden=!0;b.tabIndex=-1;(a=b.getAttribute("style"))&&b.setAttribute("data-choice-orig-style",a);b.setAttribute("data-choice","active")};c.prototype.reveal=function(){var a,b=this.element;(a=b.classList).remove.apply(a,l(this.classNames.input));b.hidden=!1;b.removeAttribute("tabindex");(a=b.getAttribute("data-choice-orig-style"))?(b.removeAttribute("data-choice-orig-style"),b.setAttribute("style",
a)):b.removeAttribute("style");b.removeAttribute("data-choice")};c.prototype.enable=function(){var a=this.element;a.removeAttribute("disabled");this.isDisabled=a.disabled=!1};c.prototype.disable=function(){var a=this.element;a.setAttribute("disabled","");this.isDisabled=a.disabled=!0};c.prototype.triggerEvent=function(a,b){var d=this.element;b=b||{};void 0===b&&(b=null);a=new CustomEvent(a,{detail:b,bubbles:!0,cancelable:!0});d.dispatchEvent(a)};return c}(),ea=function(c){function a(){return null!==
c&&c.apply(this,arguments)||this}E(a,c);return a}(R),H=function(c,a){void 0===a&&(a=!0);return"undefined"===typeof c?a:!!c},S=function(c){"string"===typeof c&&(c=c.split(" ").filter(function(a){return a.length}));if(Array.isArray(c)&&c.length)return c},w=function(c,a){if("string"===typeof c)return w({value:c,label:c},!1);if("choices"in c){if(!a)throw new TypeError("optGroup is not allowed");a=c.choices.map(function(b){return w(b,!1)});return{id:0,label:B(c.label)||c.value,active:!!a.length,disabled:!!c.disabled,
choices:a}}return{id:0,groupId:0,score:0,rank:0,value:c.value,label:c.label||c.value,active:H(c.active),selected:H(c.selected,!1),disabled:H(c.disabled,!1),placeholder:H(c.placeholder,!1),highlighted:!1,labelClass:S(c.labelClass),labelDescription:c.labelDescription,customProperties:c.customProperties}},fa=function(c){function a(b){var d=b.template,e=b.extractPlaceholder;b=c.call(this,{element:b.element,classNames:b.classNames})||this;b.template=d;b.extractPlaceholder=e;return b}E(a,c);Object.defineProperty(a.prototype,
"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0});a.prototype.addOptions=function(b){var d=this,e=document.createDocumentFragment();b.forEach(function(f){if(!f.element){var g=d.template(f);e.appendChild(g);f.element=g}});this.element.appendChild(e)};a.prototype.optionsAsChoices=function(){var b=this,d=[];this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(e){"OPTION"===
e.tagName?d.push(b._optionToChoice(e)):"OPTGROUP"===e.tagName&&d.push(b._optgroupToChoice(e))});return d};a.prototype._optionToChoice=function(b){!b.hasAttribute("value")&&b.hasAttribute("placeholder")&&(b.setAttribute("value",""),b.value="");var d=b.dataset,e=b.value,f=b.innerHTML,g=this.extractPlaceholder?b.selected:b.hasAttribute("selected"),h=b.disabled,k=this.extractPlaceholder&&(!b.value||b.hasAttribute("placeholder")),m="undefined"!==typeof d.labelClass?S(d.labelClass):void 0,p="undefined"!==
typeof d.labelDescription?d.labelDescription:void 0;a:{d=d.customProperties;if("undefined"!==typeof d)try{var q=JSON.parse(d);break a}catch(C){q=d;break a}q={}}return{id:0,groupId:0,score:0,rank:0,value:e,label:f,element:b,active:!0,selected:g,disabled:h,highlighted:!1,placeholder:k,labelClass:m,labelDescription:p,customProperties:q}};a.prototype._optgroupToChoice=function(b){var d=this,e=b.querySelectorAll("option");e=Array.from(e).map(function(f){return d._optionToChoice(f)});return{id:0,label:b.label||
"",element:b,active:!!e.length,disabled:b.disabled,choices:e}};return a}(R),T={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(c){return!!c&&""!==c},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,
searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:function(c,a){var b=c.value;c=c.label;var d=a.value;a=a.label;a=void 0===a?d:a;return B(void 0===c?b:c).localeCompare(B(a),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",
itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(c){return'Press Enter to add <b>"'.concat(c,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(c){return"Remove item: ".concat(c)},maxItemText:function(c){return"Only ".concat(c," values can be added")},valueComparer:function(c,a){return c===a},fuseOptions:{includeScore:!0},labelId:"",
callbackOnInit:null,callbackOnCreateTemplates:null,classNames:{containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],
placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},appendGroupInSearch:!1},
U={groups:function(c,a){var b=!0;switch(a.type){case "ADD_GROUP":c.push(a.group);break;case "CLEAR_CHOICES":c=[];break;default:b=!1}return{state:c,update:b}},items:function(c,a){var b=!0;switch(a.type){case "ADD_ITEM":var d=a.item;d.selected=!0;var e=d.element;e&&(e.selected=!0,e.setAttribute("selected",""));c.push(d);c.forEach(function(g){g.highlighted=!1});break;case "REMOVE_ITEM":var f=a.item;f.selected=!1;if(e=f.element)e.selected=!1,e.removeAttribute("selected"),(d=e.parentElement)&&"SELECT"===
d.tagName&&"select-one"===d.type&&(d.value="");c=c.filter(function(g){return g.id!==f.id});break;case "REMOVE_CHOICE":c=c.filter(function(g){return g.id!==a.choice.id});break;case "HIGHLIGHT_ITEM":c.forEach(function(g){g.id===a.item.id&&(g.highlighted=a.highlighted)});break;default:b=!1}return{state:c,update:b}},choices:function(c,a){var b=!0;switch(a.type){case "ADD_CHOICE":c.push(a.choice);break;case "REMOVE_CHOICE":c=c.filter(function(e){return e.id!==a.choice.id});break;case "ADD_ITEM":case "REMOVE_ITEM":break;
case "FILTER_CHOICES":var d=[];a.results.forEach(function(e){d[e.item.id]=e});c.forEach(function(e){var f=d[e.id];void 0!==f?(e.score=f.score,e.rank=f.rank,e.active=!0):(e.score=0,e.rank=0,e.active=!1)});break;case "ACTIVATE_CHOICES":c.forEach(function(e){e.active=a.active});break;case "CLEAR_CHOICES":c=[];break;default:b=!1}return{state:c,update:b}}},ha=function(){function c(){this._state=this.defaultState;this._listeners=[];this._txn=0}Object.defineProperty(c.prototype,"defaultState",{get:function(){return{groups:[],
items:[],choices:[]}},enumerable:!1,configurable:!0});c.prototype.changeSet=function(a){return{groups:a,items:a,choices:a}};c.prototype.reset=function(){this._state=this.defaultState;var a=this.changeSet(!0);this._txn?this._changeSet=a:this._listeners.forEach(function(b){return b(a)})};c.prototype.subscribe=function(a){this._listeners.push(a)};c.prototype.dispatch=function(a){var b=this._state,d=!1,e=this._changeSet||this.changeSet(!1);Object.keys(U).forEach(function(f){var g=U[f](b[f],a);g.update&&
(d=!0,e[f]=!0,b[f]=g.state)});d&&(this._txn?this._changeSet=e:this._listeners.forEach(function(f){return f(e)}))};c.prototype.withTxn=function(a){this._txn++;try{a()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var b=this._changeSet;b&&(this._changeSet=void 0,this._listeners.forEach(function(d){return d(b)}))}}};Object.defineProperty(c.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"items",{get:function(){return this.state.items},
enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(a){return!a.disabled&&a.active&&a.highlighted})},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"activeChoices",{get:function(){return this.choices.filter(function(a){return a.active})},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"searchableChoices",{get:function(){return this.choices.filter(function(a){return!a.disabled&&!a.placeholder})},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"activeGroups",{get:function(){var a=this;return this.state.groups.filter(function(b){b=b.active&&!b.disabled;var d=a.state.choices.some(function(e){return e.active&&!e.disabled});return b&&d},[])},enumerable:!1,
configurable:!0});c.prototype.inTxn=function(){return 0<this._txn};c.prototype.getChoiceById=function(a){return this.activeChoices.find(function(b){return b.id===a})};c.prototype.getGroupById=function(a){return this.groups.find(function(b){return b.id===a})};return c}(),ia=function(){function c(a){this._haystack=[];this._fields=a.searchFields}c.prototype.index=function(a){this._haystack=a};c.prototype.reset=function(){this._haystack=[]};c.prototype.isEmptyIndex=function(){return!this._haystack.length};
c.prototype.search=function(a){var b=this._fields;if(!b||!b.length||!a)return[];var d=a.toLowerCase();return this._haystack.filter(function(e){return b.some(function(f){return f in e&&e[f].toLowerCase().startsWith(d)})}).map(function(e,f){return{item:e,score:f,rank:f+1}})};return c}(),L=function(c,a,b){c=c.dataset;var d=a.customProperties,e=a.labelClass;a=a.labelDescription;e&&(c.labelClass=l(e).join(" "));a&&(c.labelDescription=a);if(b&&d)if("string"===typeof d)c.customProperties=d;else{if(b="object"===
typeof d){a:{for(f in d)if(Object.prototype.hasOwnProperty.call(d,f)){var f=!1;break a}f=!0}b=!f}b&&(c.customProperties=JSON.stringify(d))}},V=function(c,a,b){(c=(c=a&&c.querySelector("label[for='".concat(a,"']")))&&c.innerText)&&b.setAttribute("aria-label",c)},ka={containerOuter:function(c,a,b,d,e,f,g){c=c.classNames.containerOuter;var h=document.createElement("div");h.className=l(c).join(" ");h.dataset.type=f;a&&(h.dir=a);d&&(h.tabIndex=0);b&&(h.setAttribute("role",e?"combobox":"listbox"),e?h.setAttribute("aria-autocomplete",
"list"):g||V(this._docRoot,this.passedElement.element.id,h),h.setAttribute("aria-haspopup","true"),h.setAttribute("aria-expanded","false"));g&&h.setAttribute("aria-labelledby",g);return h},containerInner:function(c){c=c.classNames.containerInner;var a=document.createElement("div");a.className=l(c).join(" ");return a},itemList:function(c,a){var b=c.searchEnabled,d=c.classNames;c=d.list;var e=d.listSingle;d=d.listItems;var f=document.createElement("div");f.className="".concat(l(c).join(" ")," ").concat(a?
l(e).join(" "):l(d).join(" "));this._isSelectElement&&b&&f.setAttribute("role","listbox");return f},placeholder:function(c,a){var b=c.allowHTML;c=c.classNames.placeholder;var d=document.createElement("div");d.className=l(c).join(" ");d.innerHTML=v(b,a);return d},item:function(c,a,b){var d,e,f,g=c.allowHTML,h=c.removeItemButtonAlignLeft,k=c.removeItemIconText,m=c.removeItemLabelText;c=c.classNames;var p=c.item,q=c.button,C=c.highlightedState,F=c.itemSelectable,D=c.placeholder,x=a.labelClass,t=a.label,
n=a.disabled,z=a.value,A=B(z);c=document.createElement("div");c.className=l(p).join(" ");x?(p=document.createElement("span"),p.innerHTML=v(g,t),p.className=l(x).join(" "),c.appendChild(p)):c.innerHTML=v(g,t);g=c.dataset;g.item="";g.id=a.id;g.value=A;L(c,a,!0);(n||this.containerOuter.isDisabled)&&c.setAttribute("aria-disabled","true");this._isSelectElement&&(c.setAttribute("aria-selected","true"),c.setAttribute("role","option"));a.placeholder&&((d=c.classList).add.apply(d,l(D)),g.placeholder="");(e=
c.classList).add.apply(e,a.highlighted?l(C):l(F));b&&(n&&(f=c.classList).remove.apply(f,l(F)),g.deletable="",a=document.createElement("button"),a.type="button",a.className=l(q).join(" "),k=G(k,z),a.innerHTML=v(!0,k),(m=G(m,z))&&a.setAttribute("aria-label",m),a.dataset.button="",h?c.insertAdjacentElement("afterbegin",a):c.appendChild(a));return c},choiceList:function(c,a){c=c.classNames.list;var b=document.createElement("div");b.className=l(c).join(" ");a||b.setAttribute("aria-multiselectable","true");
b.setAttribute("role","listbox");return b},choiceGroup:function(c,a){var b=c.allowHTML,d=c.classNames,e=d.group;c=d.groupHeading;var f=d.itemDisabled,g=a.id;d=a.label;var h=a.disabled,k=B(d);a=document.createElement("div");a.className="".concat(l(e).join(" ")," ").concat(h?l(f).join(" "):"");a.setAttribute("role","group");e=a.dataset;e.group="";e.id=g;e.value=k;h&&a.setAttribute("aria-disabled","true");e=document.createElement("div");e.className=l(c).join(" ");e.innerHTML=v(b,d);a.appendChild(e);
return a},choice:function(c,a,b){var d,e,f,g,h,k=c.allowHTML,m=c.classNames,p=m.item,q=m.itemChoice;c=m.itemSelectable;var C=m.selectedState,F=m.itemDisabled,D=m.description,x=m.placeholder,t=a.elementId;m=a.groupId;var n=a.label,z=a.labelClass,A=a.labelDescription,ja=B(a.value),r=document.createElement("div");r.id=t;r.className="".concat(l(p).join(" ")," ").concat(l(q).join(" "));p=r;z?(q=document.createElement("span"),q.innerHTML=v(k,n),q.className=l(z).join(" "),p=q,r.appendChild(q)):r.innerHTML=
v(k,n);A&&(t="".concat(t,"-description"),p.setAttribute("aria-describedby",t),n=document.createElement("span"),n.innerHTML=v(k,A),n.id=t,(d=n.classList).add.apply(d,l(D)),r.appendChild(n));a.selected&&(e=r.classList).add.apply(e,l(C));a.placeholder&&(f=r.classList).add.apply(f,l(x));d=r.dataset;e=m&&0<m;r.setAttribute("role",e?"treeitem":"option");e&&(d.groupId="".concat(m));d.choice="";d.id=a.id;d.value=ja;d.selectText=b;L(r,a,!1);a.disabled?((g=r.classList).add.apply(g,l(F)),d.choiceDisabled="",
r.setAttribute("aria-disabled","true")):((h=r.classList).add.apply(h,l(c)),d.choiceSelectable="");return r},input:function(c,a){var b=c.classNames,d=b.input;b=b.inputCloned;c=c.labelId;var e=document.createElement("input");e.type="search";e.className="".concat(l(d).join(" ")," ").concat(l(b).join(" "));e.autocomplete="off";e.autocapitalize="off";e.spellcheck=!1;e.setAttribute("role","textbox");e.setAttribute("aria-autocomplete","list");a?e.setAttribute("aria-label",a):c||V(this._docRoot,this.passedElement.element.id,
e);return e},dropdown:function(c){var a,b,d=c.classNames;c=d.list;d=d.listDropdown;var e=document.createElement("div");(a=e.classList).add.apply(a,l(c));(b=e.classList).add.apply(b,l(d));e.setAttribute("aria-expanded","false");return e},notice:function(c,a,b){var d=c.classNames,e=d.item,f=d.itemChoice;c=d.addChoice;var g=d.noResults,h=d.noChoices;d=d.notice;void 0===b&&(b="");e=y(y(y([],l(e),!0),l(f),!0),l(d),!0);switch(b){case "add-choice":e.push.apply(e,l(c));break;case "no-results":e.push.apply(e,
l(g));break;case "no-choices":e.push.apply(e,l(h))}c=document.createElement("div");c.innerHTML=v(!0,a);c.className=e.join(" ");"add-choice"===b&&(a=c.dataset,a.choiceSelectable="",a.choice="");return c},option:function(c){var a=B(c.label);a=new Option(a,c.value,!1,c.selected);L(a,c,!0);a.disabled=c.disabled;c.selected&&a.setAttribute("selected","");return a}},la="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,ma={},M=function(c){if(c)return(c=
c.dataset.id)?parseInt(c,10):void 0};return function(){function c(a,b){void 0===a&&(a="[data-choice]");void 0===b&&(b={});var d=this;this.initialisedOK=void 0;this._hasNonChoicePlaceholder=!1;this._lastAddedGroupId=this._lastAddedChoiceId=0;var e=c.defaults;this.config=u(u(u({},e.allOptions),e.options),b);W.forEach(function(k){d.config[k]=u(u(u({},e.allOptions[k]),e.options[k]),b[k])});var f=this.config;f.silent||this._validateConfig();var g=f.shadowRoot||document.documentElement;this._docRoot=g;
g="string"===typeof a?g.querySelector(a):a;if(!g||"object"!==typeof g||"INPUT"!==g.tagName&&"SELECT"!==g.tagName){if(!g&&"string"===typeof a)throw TypeError("Selector ".concat(a," failed to find an element"));throw TypeError("Expected one of the following types text|select-one|select-multiple");}this._elementType=g.type;if((this._isTextElement="text"===this._elementType)||1!==f.maxItemCount)f.singleModeForMultiSelect=!1;f.singleModeForMultiSelect&&(this._elementType="select-multiple");this._isSelectOneElement=
"select-one"===this._elementType;this._isSelectMultipleElement="select-multiple"===this._elementType;this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement;this._canAddUserChoices=this._isTextElement&&f.addItems||this._isSelectElement&&f.addChoices;["auto","always"].includes("".concat(f.renderSelectedChoices))||(f.renderSelectedChoices="auto");f.closeDropdownOnSelect="auto"===f.closeDropdownOnSelect?this._isTextElement||this._isSelectOneElement||f.singleModeForMultiSelect:H(f.closeDropdownOnSelect);
f.placeholder&&(f.placeholderValue?this._hasNonChoicePlaceholder=!0:g.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,f.placeholderValue=g.dataset.placeholder));if(b.addItemFilter&&"function"!==typeof b.addItemFilter){var h=b.addItemFilter instanceof RegExp?b.addItemFilter:new RegExp(b.addItemFilter);f.addItemFilter=h.test.bind(h)}this.passedElement=this._isTextElement?new ea({element:g,classNames:f.classNames}):new fa({element:g,classNames:f.classNames,template:function(k){return d._templates.option(k)},
extractPlaceholder:f.placeholder&&!this._hasNonChoicePlaceholder});this.initialised=!1;this._store=new ha;this._currentValue="";f.searchEnabled=!this._isTextElement&&f.searchEnabled||"select-multiple"===this._elementType;this._canSearch=f.searchEnabled;this._isScrollingOnIe=!1;this._highlightPosition=0;this._wasTap=!0;this._placeholderValue=this._generatePlaceholderValue();this._baseId=X(g,"choices-");this._direction=this.passedElement.dir;this._direction||(g=window.getComputedStyle(this.passedElement.element).direction,
h=window.getComputedStyle(document.documentElement).direction,g!==h&&(this._direction=g));this._idNames={itemChoice:"item-choice"};this._templates=e.templates;this._render=this._render.bind(this);this._onFocus=this._onFocus.bind(this);this._onBlur=this._onBlur.bind(this);this._onKeyUp=this._onKeyUp.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this._onInput=this._onInput.bind(this);this._onClick=this._onClick.bind(this);this._onTouchMove=this._onTouchMove.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);
this._onMouseDown=this._onMouseDown.bind(this);this._onMouseOver=this._onMouseOver.bind(this);this._onFormReset=this._onFormReset.bind(this);this._onSelectKey=this._onSelectKey.bind(this);this._onEnterKey=this._onEnterKey.bind(this);this._onEscapeKey=this._onEscapeKey.bind(this);this._onDirectionKey=this._onDirectionKey.bind(this);this._onDeleteKey=this._onDeleteKey.bind(this);this.passedElement.isActive?(f.silent||console.warn("Trying to initialise Choices on element already initialised",{element:a}),
this.initialised=!0,this.initialisedOK=!1):(this.init(),this._initialItems=this._store.items.map(function(k){return k.value}))}Object.defineProperty(c,"defaults",{get:function(){return Object.preventExtensions({get options(){return ma},get allOptions(){return T},get templates(){return ka}})},enumerable:!1,configurable:!0});c.prototype.init=function(){if(!this.initialised&&void 0===this.initialisedOK){this._searcher=new ia(this.config);this._loadChoices();this._createTemplates();this._createElements();
this._createStructure();this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners());this._initStore();this.initialisedOK=this.initialised=!0;var a=this.config.callbackOnInit;a&&"function"===typeof a&&a.call(this)}};c.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),
this._store._listeners=[],this.clearStore(),this._stopSearch(),this._templates=c.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)};c.prototype.enable=function(){var a=this.passedElement,b=this.containerOuter;a.isDisabled&&a.enable();b.isDisabled&&(this._addEventListeners(),this.input.enable(),b.enable(),this._render());return this};c.prototype.disable=function(){var a=this.passedElement,b=this.containerOuter;a.isDisabled||a.disable();b.isDisabled||(this._removeEventListeners(),this.input.disable(),
b.disable(),this._render());return this};c.prototype.highlightItem=function(a,b){void 0===b&&(b=!0);if(!a||!a.id)return this;var d=this._store.choices.find(function(e){return e.id===a.id});if(!d||d.highlighted)return this;this._store.dispatch({type:"HIGHLIGHT_ITEM",item:d,highlighted:!0});b&&this.passedElement.triggerEvent("highlightItem",this._getChoiceForOutput(d));return this};c.prototype.unhighlightItem=function(a,b){void 0===b&&(b=!0);if(!a||!a.id)return this;var d=this._store.choices.find(function(e){return e.id===
a.id});if(!d||!d.highlighted)return this;this._store.dispatch({type:"HIGHLIGHT_ITEM",item:d,highlighted:!1});b&&this.passedElement.triggerEvent("highlightItem",this._getChoiceForOutput(d));return this};c.prototype.highlightAll=function(){var a=this;this._store.withTxn(function(){a._store.items.forEach(function(b){return a.highlightItem(b)})});return this};c.prototype.unhighlightAll=function(){var a=this;this._store.withTxn(function(){a._store.items.forEach(function(b){return a.unhighlightItem(b)})});
return this};c.prototype.removeActiveItemsByValue=function(a){var b=this;this._store.withTxn(function(){b._store.items.filter(function(d){return d.value===a}).forEach(function(d){return b._removeItem(d)})});return this};c.prototype.removeActiveItems=function(a){var b=this;this._store.withTxn(function(){b._store.items.filter(function(d){return d.id!==a}).forEach(function(d){return b._removeItem(d)})});return this};c.prototype.removeHighlightedItems=function(a){var b=this;void 0===a&&(a=!1);this._store.withTxn(function(){b._store.highlightedActiveItems.forEach(function(d){b._removeItem(d);
a&&b._triggerChange(d.value)})});return this};c.prototype.showDropdown=function(a){var b=this;if(this.dropdown.isActive)return this;requestAnimationFrame(function(){b.dropdown.show();b.containerOuter.open(b.dropdown.distanceFromTopWindow);!a&&b._canSearch&&b.input.focus();b.passedElement.triggerEvent("showDropdown")});return this};c.prototype.hideDropdown=function(a){var b=this;if(!this.dropdown.isActive)return this;requestAnimationFrame(function(){b.dropdown.hide();b.containerOuter.close();!a&&b._canSearch&&
(b.input.removeActiveDescendant(),b.input.blur());b.passedElement.triggerEvent("hideDropdown")});return this};c.prototype.getValue=function(a){var b=this;void 0===a&&(a=!1);var d=this._store.items.reduce(function(e,f){f=a?f.value:b._getChoiceForOutput(f);e.push(f);return e},[]);return this._isSelectOneElement||this.config.singleModeForMultiSelect?d[0]:d};c.prototype.setValue=function(a){var b=this;if(!this.initialisedOK)return this._warnChoicesInitFailed("setValue"),this;this._store.withTxn(function(){a.forEach(function(d){d&&
b._addChoice(w(d,!1))})});this._searcher.reset();return this};c.prototype.setChoiceByValue=function(a){var b=this;if(!this.initialisedOK)return this._warnChoicesInitFailed("setChoiceByValue"),this;if(this._isTextElement)return this;this._store.withTxn(function(){(Array.isArray(a)?a:[a]).forEach(function(d){return b._findAndSelectChoiceByValue(d)})});this._searcher.reset();return this};c.prototype.setChoices=function(a,b,d,e){var f=this;void 0===a&&(a=[]);void 0===b&&(b="value");void 0===d&&(d="label");
void 0===e&&(e=!1);if(!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if("string"!==typeof b||!b)throw new TypeError("value parameter must be a name of 'value' field in passed objects");e&&this.clearChoices();if("function"===typeof a){var g=a(this);if("function"===typeof Promise&&g instanceof Promise)return(new Promise(function(h){return requestAnimationFrame(h)})).then(function(){return f._handleLoadingState(!0)}).then(function(){return g}).then(function(h){return f.setChoices(h,
b,d,e)}).catch(function(h){f.config.silent||console.error(h)}).then(function(){return f._handleLoadingState(!1)}).then(function(){return f});if(!Array.isArray(g))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof g));return this.setChoices(g,b,d,!1)}if(!Array.isArray(a))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");this.containerOuter.removeLoadingState();
this._store.withTxn(function(){var h="value"===b,k="label"===d;a.forEach(function(m){"choices"in m?(k||(m=u(u({},m),{label:m[d]})),f._addGroup(w(m,!0))):(k&&h||(m=u(u({},m),{value:m[b],label:m[d]})),f._addChoice(w(m,!1)))})});this._searcher.reset();return this};c.prototype.refresh=function(a,b,d){var e=this;void 0===a&&(a=!1);void 0===b&&(b=!1);void 0===d&&(d=!1);if(!this._isSelectElement)return this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),
this;this._store.withTxn(function(){var f=e.passedElement.optionsAsChoices(),g=e._store.items,h={};d||g.forEach(function(k){k.id&&k.active&&k.selected&&!k.disabled&&(h[k.value]=!0)});f.forEach(function(k){"choices"in k||(d?k.selected=!1:h[k.value]&&(k.selected=!0))});e.clearStore();e._addPredefinedChoices(f,b,a);e._isSearching&&e._searchChoices(e.input.value)});return this};c.prototype.removeChoice=function(a){var b=this._store.choices.find(function(d){return d.value===a});if(!b)return this;this._store.dispatch({type:"REMOVE_CHOICE",
choice:b});this._searcher.reset();b.selected&&this.passedElement.triggerEvent("removeItem",this._getChoiceForOutput(b));return this};c.prototype.clearChoices=function(){this.passedElement.element.innerHTML="";this._store.dispatch({type:"CLEAR_CHOICES"});this._searcher.reset();return this};c.prototype.clearStore=function(){this._store.reset();this._lastAddedGroupId=this._lastAddedChoiceId=0;this._searcher.reset();return this};c.prototype.clearInput=function(){this.input.clear(!this._isSelectOneElement);
this._clearNotice();this._isSearching&&this._stopSearch();return this};c.prototype._validateConfig=function(){var a=this.config,b=ba(a,T);b.length&&console.warn("Unknown config option(s) passed",b.join(", "));a.allowHTML&&a.allowHtmlUserInput&&(a.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),a.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))};
c.prototype._render=function(a){void 0===a&&(a={choices:!0,groups:!0,items:!0});this._store.inTxn()||(this._isSelectElement&&(a.choices||a.groups)&&this._renderChoices(),a.items&&this._renderItems())};c.prototype._renderChoices=function(){var a=this;this.choiceList.clear();if(this._canAddItems()){var b=this.config,d=this._store,e=d.activeGroups,f=d.activeChoices;d=document.createDocumentFragment();var g=!0;f.length&&(b.resetScrollPosition&&requestAnimationFrame(function(){return a.choiceList.scrollToTop()}),
e.length&&!this._isSearching?(this._hasNonChoicePlaceholder||(g=f.filter(function(h){return h.placeholder&&-1===h.groupId}),g.length&&(d=this._createChoicesFragment(g,d))),d=this._createGroupsFragment(e,f,d)):d=this._createChoicesFragment(f,d),g=!d.childNodes.length);e=this._notice;g?e||(this._notice={text:O(b.noChoicesText),type:"no-choices"}):e&&"no-choices"===e.type&&(this._notice=void 0);this._renderNotice();g||(this.choiceList.element.append(d),this._highlightChoice())}};c.prototype._renderItems=
function(){var a=this._store.items||[];this.itemList.clear();a=this._createItemsFragment(a);a.childNodes.length&&this.itemList.element.append(a)};c.prototype._createGroupsFragment=function(a,b,d){var e=this;void 0===d&&(d=document.createDocumentFragment());var f=this.config,g=function(k){return b.filter(function(m){return e._isSelectOneElement?m.groupId===k.id:m.groupId===k.id&&("always"===f.renderSelectedChoices||!m.selected)})};f.shouldSort&&a.sort(f.sorter);var h=b.filter(function(k){return!k.groupId});
h.length&&this._createChoicesFragment(h,d,!1);a.forEach(function(k){var m=g(k);m.length&&(k=e._templates.choiceGroup(e.config,k),d.appendChild(k),e._createChoicesFragment(m,d,!0))});return d};c.prototype._createChoicesFragment=function(a,b,d){var e=this;void 0===b&&(b=document.createDocumentFragment());void 0===d&&(d=!1);var f=this.config,g=this._isSearching,h=this._isSelectOneElement,k=f.searchResultLimit,m=f.renderChoiceLimit,p=[],q=f.appendGroupInSearch&&g;q&&this._store.groups.forEach(function(n){p[n.id]=
n.label});if(this._isSelectElement){var C=a.filter(function(n){return!n.element});C.length&&this.passedElement.addOptions(C)}var F="auto"===f.renderSelectedChoices&&!h,D=[],x=[];a.forEach(function(n){g&&!n.rank||F&&n.selected||(e._hasNonChoicePlaceholder||!n.placeholder?x.push(n):D.push(n))});g?x.sort(aa):f.shouldSort&&x.sort(f.sorter);a=h&&D.length?y(y([],D,!0),x,!0):x;var t=a.length;h=t;g&&0<k?h=k:0<m&&!d&&(h=m);h<t&&(t=h);t--;a.every(function(n,z){var A=e._templates.choice(f,n,f.itemSelectText);
q&&0<n.groupId&&(n=p[n.groupId])&&(A.innerHTML+=" (".concat(n,")"));b.appendChild(A);return z<t});return b};c.prototype._createItemsFragment=function(a,b){var d=this;void 0===b&&(b=document.createDocumentFragment());var e=this.config,f=e.sorter,g=e.removeItemButton,h=e.delimiter;e.shouldSortItems&&!this._isSelectOneElement&&a.sort(f);this._isTextElement&&(this.passedElement.value=a.map(function(k){return k.value}).join(h));f=function(k){k=d._templates.item(e,k,g);b.appendChild(k)};a.forEach(f);this._isSelectOneElement&&
this._hasNonChoicePlaceholder&&!a.length&&f(w({selected:!0,value:"",label:this.config.placeholderValue||"",active:!0,placeholder:!0},!1));return b};c.prototype._displayNotice=function(a,b,d){void 0===d&&(d=!0);var e=this._notice;e&&(e.type===b&&e.text===a||"add-choice"===e.type&&("no-results"===b||"no-choices"===b))?d&&this.showDropdown(!0):(this._clearNotice(),this._notice=a?{text:a,type:b}:void 0,this._renderNotice(),d&&a&&this.showDropdown(!0))};c.prototype._clearNotice=function(){if(this._notice){var a=
this.choiceList.element.querySelector(J(this.config.classNames.notice));a&&a.remove();this._notice=void 0}};c.prototype._renderNotice=function(){var a=this._notice;a&&(a=this._templates.notice(this.config,a.text,a.type),this.choiceList.prepend(a))};c.prototype._getChoiceForOutput=function(a,b){if(a){var d=0<a.groupId?this._store.getGroupById(a.groupId):null;return{id:a.id,highlighted:a.highlighted,labelClass:a.labelClass,labelDescription:a.labelDescription,customProperties:a.customProperties,disabled:a.disabled,
active:a.active,label:a.label,placeholder:a.placeholder,value:a.value,groupValue:d&&d.label?d.label:void 0,element:a.element,keyCode:b}}};c.prototype._triggerChange=function(a){void 0!==a&&null!==a&&this.passedElement.triggerEvent("change",{value:a})};c.prototype._handleButtonAction=function(a){var b=this._store.items;if(b.length&&this.config.removeItems&&this.config.removeItemButton){var d=a&&M(a.parentNode);if(a=d&&b.find(function(e){return e.id===d}))if(this._removeItem(a),this._triggerChange(a.value),
this._isSelectOneElement&&!this._hasNonChoicePlaceholder&&(a=this._store.choices.reverse().find(function(e){return!e.disabled&&e.placeholder})))this._addItem(a),a.value&&this._triggerChange(a.value)}};c.prototype._handleItemAction=function(a,b){var d=this;void 0===b&&(b=!1);var e=this._store.items;if(e.length&&this.config.removeItems&&!this._isSelectOneElement){var f=M(a);f&&(e.forEach(function(g){g.id!==f||g.highlighted?!b&&g.highlighted&&d.unhighlightItem(g):d.highlightItem(g)}),this.input.focus())}};
c.prototype._handleChoiceAction=function(a){var b=this,d=(a=M(a))&&this._store.getChoiceById(a);if(!d||d.disabled)return!1;a=this.dropdown.isActive;if(!d.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){b._addItem(d,!0,!0);b.clearInput();b.unhighlightAll()});this._triggerChange(d.value)}a&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus());return!0};c.prototype._handleBackspace=function(a){var b=this.config;if(b.removeItems&&a.length){var d=
a[a.length-1];a=a.some(function(e){return e.highlighted});b.editItems&&!a&&d?(this.input.value=d.value,this.input.setWidth(),this._removeItem(d),this._triggerChange(d.value)):(a||this.highlightItem(d,!1),this.removeHighlightedItems(!0))}};c.prototype._loadChoices=function(){var a,b=this.config;if(this._isTextElement){this._presetChoices=b.items.map(function(d){return w(d,!1)});if(a=this.passedElement.value)a=a.split(b.delimiter).map(function(d){return w(d,!1)}),this._presetChoices=this._presetChoices.concat(a);
this._presetChoices.forEach(function(d){d.selected=!0})}else this._isSelectElement&&(this._presetChoices=b.choices.map(function(d){return w(d,!0)}),(b=this.passedElement.optionsAsChoices())&&(a=this._presetChoices).push.apply(a,b))};c.prototype._handleLoadingState=function(a){void 0===a&&(a=!0);var b=this.config;a?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?(this.itemList.clear(),this.itemList.element.append(this._templates.placeholder(b,b.loadingText))):this.input.placeholder=
b.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement||(this.input.placeholder=this._placeholderValue||""))};c.prototype._handleSearch=function(a){if(this.input.isFocussed){var b=this.config,d=b.searchFloor;b=b.searchChoices;var e=this._store.choices.some(function(f){return!f.active});null!==a&&"undefined"!==typeof a&&a.length>=d?(d=b?this._searchChoices(a):0,null!==d&&this.passedElement.triggerEvent("search",{value:a,resultCount:d})):e&&this._stopSearch()}};
c.prototype._canAddItems=function(){var a=this.config,b=a.maxItemCount,d=a.maxItemText;return!a.singleModeForMultiSelect&&0<b&&b<=this._store.items.length?(this._displayNotice("function"===typeof d?d(b):d,"add-choice"),!1):!0};c.prototype._canCreateItem=function(a){var b=this.config,d=!0,e="";d&&"function"===typeof b.addItemFilter&&!b.addItemFilter(a)&&(d=!1,e=G(b.customAddItemText,a));if(d){var f=this._store.choices.find(function(g){return b.valueComparer(g.value,a)});if(this._isSelectElement){if(f)return this._displayNotice("",
"add-choice"),!1}else this._isTextElement&&!b.duplicateItemsAllowed&&f&&(d=!1,e=G(b.uniqueItemText,a))}d&&(e=G(b.addItemText,a));e&&this._displayNotice(e,"add-choice");return d};c.prototype._searchChoices=function(a){var b=a.trim().replace(/\s{2,}/," ");if(!b.length||b===this._currentValue)return null;a=this._searcher;a.isEmptyIndex()&&a.index(this._store.searchableChoices);a=a.search(b);this._currentValue=b;this._highlightPosition=0;this._isSearching=!0;b=(b=this._notice)&&b.type;"add-choice"!==
b&&(a.length?"no-results"===b&&this._clearNotice():this._displayNotice(O(this.config.noResultsText),"no-results"));this._store.dispatch({type:"FILTER_CHOICES",results:a});return a.length};c.prototype._stopSearch=function(){var a=this._isSearching;this._currentValue="";this._isSearching=!1;a&&(this._store.dispatch({type:"ACTIVATE_CHOICES",active:!0}),this.passedElement.triggerEvent("search",{value:"",resultCount:0}))};c.prototype._addEventListeners=function(){var a=this._docRoot,b=this.containerOuter.element,
d=this.input.element;a.addEventListener("touchend",this._onTouchEnd,!0);b.addEventListener("keydown",this._onKeyDown,!0);b.addEventListener("mousedown",this._onMouseDown,!0);a.addEventListener("click",this._onClick,{passive:!0});a.addEventListener("touchmove",this._onTouchMove,{passive:!0});this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0});this._isSelectOneElement&&(b.addEventListener("focus",this._onFocus,{passive:!0}),b.addEventListener("blur",this._onBlur,{passive:!0}));
d.addEventListener("keyup",this._onKeyUp,{passive:!0});d.addEventListener("input",this._onInput,{passive:!0});d.addEventListener("focus",this._onFocus,{passive:!0});d.addEventListener("blur",this._onBlur,{passive:!0});d.form&&d.form.addEventListener("reset",this._onFormReset,{passive:!0});this.input.addEventListeners()};c.prototype._removeEventListeners=function(){var a=this._docRoot,b=this.containerOuter.element,d=this.input.element;a.removeEventListener("touchend",this._onTouchEnd,!0);b.removeEventListener("keydown",
this._onKeyDown,!0);b.removeEventListener("mousedown",this._onMouseDown,!0);a.removeEventListener("click",this._onClick);a.removeEventListener("touchmove",this._onTouchMove);this.dropdown.element.removeEventListener("mouseover",this._onMouseOver);this._isSelectOneElement&&(b.removeEventListener("focus",this._onFocus),b.removeEventListener("blur",this._onBlur));d.removeEventListener("keyup",this._onKeyUp);d.removeEventListener("input",this._onInput);d.removeEventListener("focus",this._onFocus);d.removeEventListener("blur",
this._onBlur);d.form&&d.form.removeEventListener("reset",this._onFormReset);this.input.removeEventListeners()};c.prototype._onKeyDown=function(a){var b=a.keyCode,d=this._store.items,e=this.input.isFocussed,f=this.dropdown.isActive,g=this.itemList.element.hasChildNodes(),h=1===a.key.length||2===a.key.length&&55296<=a.key.charCodeAt(0)||"Unidentified"===a.key;this._isTextElement||f||(this.showDropdown(),!this.input.isFocussed&&h&&(this.input.value+=a.key," "===a.key&&a.preventDefault()));switch(b){case 65:return this._onSelectKey(a,
g);case 13:return this._onEnterKey(a,f);case 27:return this._onEscapeKey(a,f);case 38:case 33:case 40:case 34:return this._onDirectionKey(a,f);case 8:case 46:return this._onDeleteKey(a,d,e)}};c.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled};c.prototype._onInput=function(){var a=this.input.value;a?this._canAddItems()&&(this._canSearch&&this._handleSearch(a),this._canAddUserChoices&&(this._canCreateItem(a),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice()))):
(this._isTextElement?this.hideDropdown(!0):this._stopSearch(),this._clearNotice())};c.prototype._onSelectKey=function(a,b){var d=a.metaKey;(a.ctrlKey||d)&&b&&(this._canSearch=!1,this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement&&this.highlightAll())};c.prototype._onEnterKey=function(a,b){var d=this,e=this.config,f=this.input.value,g=a.target,h=g&&g.hasAttribute("data-button");a.preventDefault();if(h)this._handleButtonAction(g);else if(b){if(a=this.dropdown.element.querySelector(J(e.classNames.highlightedState)),
!a||!this._handleChoiceAction(a))if(!g||!f)this.hideDropdown(!0);else if(this._canAddItems()){var k=!1;this._store.withTxn(function(){k=d._findAndSelectChoiceByValue(f,!0);if(!k){if(!d._canAddUserChoices||!d._canCreateItem(f))return;var m=I(f);m=e.allowHtmlUserInput||m===f?f:{escaped:m,raw:f};d._addChoice(w({value:m,label:m,selected:!0},!1),!0,!0);k=!0}d.clearInput();d.unhighlightAll()});k&&(this._triggerChange(f),e.closeDropdownOnSelect&&this.hideDropdown(!0))}}else(this._isSelectElement||this._notice)&&
this.showDropdown()};c.prototype._onEscapeKey=function(a,b){b&&(a.stopPropagation(),this.hideDropdown(!0),this.containerOuter.element.focus())};c.prototype._onDirectionKey=function(a,b){var d=a.keyCode,e=a.metaKey;if(b||this._isSelectOneElement){this.showDropdown();this._canSearch=!1;b=40===d||34===d?1:-1;if(e||34===d||33===d)d=0<b?this.dropdown.element.querySelector("".concat("[data-choice-selectable]",":last-of-type")):this.dropdown.element.querySelector("[data-choice-selectable]");else if(d=this.dropdown.element.querySelector(J(this.config.classNames.highlightedState)))a:{e=
b;void 0===e&&(e=1);e="".concat(0<e?"next":"previous","ElementSibling");for(d=d[e];d;){if(d.matches("[data-choice-selectable]"))break a;d=d[e]}d=null}else d=this.dropdown.element.querySelector("[data-choice-selectable]");if(d){e=d;var f=this.choiceList.element,g=b;void 0===g&&(g=1);(0<g?f.scrollTop+f.offsetHeight>=e.offsetTop+e.offsetHeight:e.offsetTop>=f.scrollTop)||this.choiceList.scrollToChildElement(d,b);this._highlightChoice(d)}a.preventDefault()}};c.prototype._onDeleteKey=function(a,b,d){var e=
a.target;this._isSelectOneElement||e.value||!d||(this._handleBackspace(b),a.preventDefault())};c.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)};c.prototype._onTouchEnd=function(a){var b=(a||a.touches[0]).target;if(this._wasTap&&this.containerOuter.element.contains(b)){if(b===this.containerOuter.element||b===this.containerInner.element)this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown();a.stopPropagation()}this._wasTap=!0};c.prototype._onMouseDown=
function(a){var b=a.target;if(b instanceof HTMLElement){if(la&&this.choiceList.element.contains(b)){var d=this.choiceList.element.firstElementChild;this._isScrollingOnIe="ltr"===this._direction?a.offsetX>=d.offsetWidth:a.offsetX<d.offsetLeft}if(b!==this.input.element){b=b.closest("[data-button],[data-item],[data-choice]");if(b instanceof HTMLElement){d=a.shiftKey;var e=b.dataset;"button"in e?this._handleButtonAction(b):"item"in e?this._handleItemAction(b,d):"choice"in e&&this._handleChoiceAction(b)}a.preventDefault()}}};
c.prototype._onMouseOver=function(a){a=a.target;a instanceof HTMLElement&&"choice"in a.dataset&&this._highlightChoice(a)};c.prototype._onClick=function(a){a=a.target;var b=this.containerOuter;b.element.contains(a)?this.dropdown.isActive||this.containerOuter.isDisabled?this._isSelectOneElement&&a!==this.input.element&&!this.dropdown.element.contains(a)&&this.hideDropdown():this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),b.element.focus()):(this._store.highlightedActiveItems.length&&
this.unhighlightAll(),b.removeFocusState(),this.hideDropdown(!0))};c.prototype._onFocus=function(a){var b,d=this;a=a.target;var e=this.containerOuter;if(a&&e.element.contains(a)){var f=a===this.input.element;(b={},b.text=function(){f&&e.addFocusState()},b["select-one"]=function(){e.addFocusState();f&&d.showDropdown(!0)},b["select-multiple"]=function(){f&&(d.showDropdown(!0),e.addFocusState())},b)[this._elementType]()}};c.prototype._onBlur=function(a){var b,d=this,e=a.target,f=this.containerOuter;
if(e&&f.element.contains(e)&&!this._isScrollingOnIe){var g=this._store.activeChoices.some(function(k){return k.highlighted}),h=e===this.input.element;(b={},b.text=function(){h&&(f.removeFocusState(),g&&d.unhighlightAll(),d.hideDropdown(!0))},b["select-one"]=function(){f.removeFocusState();(h||e===f.element&&!d._canSearch)&&d.hideDropdown(!0)},b["select-multiple"]=function(){h&&(f.removeFocusState(),d.hideDropdown(!0),g&&d.unhighlightAll())},b)[this._elementType]()}else this._isScrollingOnIe=!1,this.input.element.focus()};
c.prototype._onFormReset=function(){var a=this;this._store.withTxn(function(){a.clearInput();a.hideDropdown();a.refresh(!1,!1,!0);a._initialItems.length&&a.setChoiceByValue(a._initialItems)})};c.prototype._highlightChoice=function(a){var b;void 0===a&&(a=null);var d=this.config.classNames.highlightedState,e=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));e.length&&(Array.from(this.dropdown.element.querySelectorAll(J(d))).forEach(function(f){var g;(g=f.classList).remove.apply(g,
l(d));f.setAttribute("aria-selected","false")}),a?this._highlightPosition=e.indexOf(a):(a=e.length>this._highlightPosition?e[this._highlightPosition]:e[e.length-1])||(a=e[0]),(b=a.classList).add.apply(b,l(d)),a.setAttribute("aria-selected","true"),this.passedElement.triggerEvent("highlightChoice",{el:a}),this.dropdown.isActive&&(this.input.setActiveDescendant(a.id),this.containerOuter.setActiveDescendant(a.id)))};c.prototype._addItem=function(a,b,d){void 0===b&&(b=!0);void 0===d&&(d=!1);var e=a.id;
if(!e)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e);this._store.dispatch({type:"ADD_ITEM",item:a});b&&(this.passedElement.triggerEvent("addItem",this._getChoiceForOutput(a)),d&&this.passedElement.triggerEvent("choice",this._getChoiceForOutput(a)))};c.prototype._removeItem=function(a){a.id&&(this._store.dispatch({type:"REMOVE_ITEM",item:a}),this.passedElement.triggerEvent("removeItem",
this._getChoiceForOutput(a)))};c.prototype._addChoice=function(a,b,d){void 0===b&&(b=!0);void 0===d&&(d=!1);if(a.id)throw new TypeError("Can not re-add a choice which has already been added");this._lastAddedChoiceId++;a.id=this._lastAddedChoiceId;a.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(a.id);var e=this.config,f=e.prependValue;e=e.appendValue;f&&(a.value=f+a.value);e&&(a.value+=e.toString());(f||e)&&a.element&&(a.element.value=a.value);this._store.dispatch({type:"ADD_CHOICE",
choice:a});a.selected&&this._addItem(a,b,d)};c.prototype._addGroup=function(a,b){var d=this;void 0===b&&(b=!0);if(a.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch({type:"ADD_GROUP",group:a});if(a.choices){this._lastAddedGroupId++;a.id=this._lastAddedGroupId;var e=a.id,f=a.choices;a.choices=[];f.forEach(function(g){g.groupId=e;a.disabled&&(g.disabled=!0);d._addChoice(g,b)})}};c.prototype._createTemplates=function(){var a=this,b=this.config.callbackOnCreateTemplates,
d={};b&&"function"===typeof b&&(d=b.call(this,Y,v));var e={};Object.keys(this._templates).forEach(function(f){e[f]=f in d?d[f].bind(a):a._templates[f].bind(a)});this._templates=e};c.prototype._createElements=function(){var a=this._templates,b=this.config,d=b.position,e=b.classNames,f=this._elementType;this.containerOuter=new P({element:a.containerOuter(b,this._direction,this._isSelectElement,this._isSelectOneElement,b.searchEnabled,f,b.labelId),classNames:e,type:f,position:d});this.containerInner=
new P({element:a.containerInner(b),classNames:e,type:f,position:d});this.input=new da({element:a.input(b,this._placeholderValue),classNames:e,type:f,preventPaste:!b.paste});this.choiceList=new Q({element:a.choiceList(b,this._isSelectOneElement)});this.itemList=new Q({element:a.itemList(b,this._isSelectOneElement)});this.dropdown=new ca({element:a.dropdown(b),classNames:e,type:f})};c.prototype._createStructure=function(){var a=this.containerInner,b=this.containerOuter,d=this.passedElement,e=this.dropdown,
f=this.input;d.conceal();a.wrap(d.element);b.wrap(a.element);this._isSelectOneElement?f.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(f.placeholder=this._placeholderValue),f.setWidth());b.element.appendChild(a.element);b.element.appendChild(e.element);a.element.appendChild(this.itemList.element);e.element.appendChild(this.choiceList.element);this._isSelectOneElement?this.config.searchEnabled&&e.element.insertBefore(f.element,e.element.firstChild):a.element.appendChild(f.element);
this._highlightPosition=0;this._isSearching=!1};c.prototype._initStore=function(){var a=this;this._store.subscribe(this._render);this._store.withTxn(function(){a._addPredefinedChoices(a._presetChoices,a._isSelectOneElement&&!a._hasNonChoicePlaceholder,!1)});this._isSelectOneElement&&this._hasNonChoicePlaceholder&&this._render({choices:!1,groups:!1,items:!0})};c.prototype._addPredefinedChoices=function(a,b,d){var e=this;void 0===b&&(b=!1);void 0===d&&(d=!0);b&&-1===a.findIndex(function(f){return f.selected})&&
a.some(function(f){return f.disabled||"choices"in f?!1:f.selected=!0});a.forEach(function(f){"choices"in f?e._isSelectElement&&e._addGroup(f,d):e._addChoice(f,d)})};c.prototype._findAndSelectChoiceByValue=function(a,b){var d=this;void 0===b&&(b=!1);var e=this._store.choices.find(function(f){return d.config.valueComparer(f.value,a)});return!e||e.disabled||e.selected?!1:(this._addItem(e,!0,b),!0)};c.prototype._generatePlaceholderValue=function(){var a=this.config;return a.placeholder?this._hasNonChoicePlaceholder?
a.placeholderValue:this._isSelectElement?(a=this.passedElement.placeholderOption)?a.text:null:null:null};c.prototype._warnChoicesInitFailed=function(a){if(!this.config.silent){if(!this.initialised)throw new TypeError("".concat(a," called on a non-initialised instance of Choices"));if(!this.initialisedOK)throw new TypeError("".concat(a," called for an element which has multiple instances of Choices initialised on it"));}};c.version="11.0.0-rc8";return c}()});
