var SV=window.SV||{};SV.$=SV.$||window.jQuery||null;
!function(e,l){var g=SV.$;SV.AjaxPagination=XF.Element.newHandler({options:{pageNavWrapper:".block-outer--page-nav-wrapper",contentWrapper:null,perPageDropdown:'select[name="per_page"]',perPageCookiePrefix:null},perPageDropdown:null,finalUrl:null,inOverlay:!1,changeTimer:null,lastPageSelected:null,init:function(){var a=this.target||this.$target.get(0);this.inOverlay=null!==a.closest(".overlay-container");if(!this.options.contentWrapper)return console.error("No content wrapper query expression defined"),null;
var b=a.querySelector('input[type="hidden"][name="final_url"]');if(null===b)console.error("No final URL input was provided.");else if(b=b.value){this.finalUrl=b;b=null;var d=this.getPageNavWrappers();null!==d&&(d=d[0].querySelector(".pageNav-page--current > a"))&&(b=this.getPageFromAhref(d));this.lastPageSelected="number"===typeof b?b:1;this.shimDynamicPageNav();this.perPageDropdown=a.querySelector(this.options.perPageDropdown);if(null!==this.perPageDropdown)if("function"!==typeof XF.on)g(this.perPageDropdown).on("change",
this.perPageChange.bind(this));else XF.on(this.perPageDropdown,"change",this.perPageChange.bind(this))}else console.error("No final URL available.")},perPageChange:function(){this.changeTimer&&clearTimeout(this.changeTimer);this.changeTimer=setTimeout(this.perPageOnTimer.bind(this),200)},perPageOnTimer:function(){var a=this.perPageDropdown.value;a&&(null!==this.options.perPageCookiePrefix&&XF.Cookie.set(this.options.perPageCookiePrefix+"per_page",a,new Date((new Date).setFullYear((new Date).getFullYear()+
1))),a=new Url(this.finalUrl),a.query.per_page=this.perPageDropdown.value,XF.ajax("GET",a.toString(),{},this._paginationAjaxResponse.bind(this)))},_paginationAjaxResponse:function(a){var b=this.getPageNavWrappers();if(null!==b){var d=this.getContentWrapper();null!==d&&(a.html.content="<div>"+a.html.content.trim()+"</div>",XF.setupHtmlInsert(a.html,c=>{"undefined"===typeof XF.createElementFromString&&(c=c.get(0));var h=c.querySelector(this.options.pageNavWrapper),k=c.querySelector(this.options.contentWrapper);
null===h?b.forEach(function(f){f.innerHTML=""}):null===k?d.innerHTML="":(b.forEach(function(f){f.innerHTML=h.innerHTML}),this.shimDynamicPageNav(),d.innerHTML=k.innerHTML,this.shimDynamicContent(),this.inOverlay||(c=c.querySelector('input[type="hidden"][name="final_url"]'),null===c?console.error("No final URL input was provided."):(c=c.value)?(this.finalUrl=c,"pushState"in e.history?e.history.pushState({state:1,rand:Math.random()},"",c):e.location=c):console.error("No final URL available.")))}))}},
shimDynamicPageNav:function(){var a=this.getPageNavWrappers();if(null!==a)if("function"===typeof XF.on)for(const b of a){for(const d of b.querySelectorAll(".pageNav a[href]"))XF.on(d,"click",this.ajaxLoadNewPage.bind(this));XF.activate(b)}else a=g(a),a.find(".pageNav a[href]").on("click",this.ajaxLoadNewPage.bind(this)),XF.activate(a)},shimDynamicContent:function(){var a=this.getContentWrapper();a&&XF.activate(a)},getPageFromAhref:function(a){a=a.getAttribute("href");if(!a)return 1;a=new Url(a);return"page"in
a.query?parseInt(a.query.page)||1:1},ajaxLoadNewPage:function(a){a.preventDefault();var b=this.getPageFromAhref(a.target);if(b!==this.lastPageSelected){this.lastPageSelected=b;this.resetPage=!1;try{XF.ajax("GET",a.target.getAttribute("href"),{},this._paginationAjaxResponse.bind(this))}finally{this.resetPage=!0}}},getPageNavWrappers:function(a){a="undefined"===typeof a?!0:a;if(!this.options.pageNavWrapper)return a&&console.error("No pagination wrapper query expression defined"),null;var b=(this.target||
this.$target.get(0)).querySelectorAll(this.options.pageNavWrapper);return null===b||0===b.length?(a&&console.error("No old pagination wrapper available"),null):b},getContentWrapper:function(a){a="undefined"===typeof a?!0:a;var b=(this.target||this.$target.get(0)).querySelector(this.options.contentWrapper);return null===b?(a&&console.error("No old content wrapper available"),null):b},getCurrentPage:function(){if(!this.options.pageNavWrapper||null===this.getPageNavWrappers(!1))return null;var a=parseInt(this.lastPageSelected)||
null;return a?a:null}});XF.Element.register("sv-ajax-pagination","SV.AjaxPagination")}(window,document);
