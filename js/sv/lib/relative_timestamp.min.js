var SV=window.SV||{};SV.StandardLib=SV.StandardLib||{};SV.$=SV.$||window.jQuery||null;
(function(){var f=SV.$;"function"===typeof moment&&function(){let a={d:"DD",D:"ddd",j:"D",l:"dddd",N:"E",S:function(){return"["+this.format("Do").replace(/\d*/g,"")+"]"},w:"d",z:function(){return this.format("DDD")-1},W:"W",F:"MMMM",m:"MM",M:"MMM",n:"M",t:function(){return this.daysInMonth()},L:function(){return this.isLeapYear()?1:0},o:"GGGG",Y:"YYYY",y:"YY",a:"a",A:"A",B:function(){var c=this.clone().utc();c=(c.hours()+1)%24+c.minutes()/60+c.seconds()/3600;return Math.floor(1E3*c/24)},g:"h",G:"H",
h:"hh",H:"HH",i:"mm",s:"ss",u:"[u]",e:"[e]",I:function(){return this.isDST()?1:0},O:"ZZ",P:"Z",T:"[T]",Z:function(){return 36*parseInt(this.format("ZZ"),10)},c:"YYYY-MM-DD[T]HH:mm:ssZ",r:"ddd, DD MMM YYYY HH:mm:ss ZZ",U:"X"},b=/[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g;moment.fn.formatPHP=function(c){let e=this;return this.format(c.replace(b,function(d){return"function"===typeof a[d]?a[d].call(e):a[d]}))}}();SV.StandardLib.RelativeTimestamp=XF.Element.newHandler({options:{countUp:!1,timestamp:null,
dateFormat:null,timeFormat:null,triggerEvent:null,triggerEventOnSelector:null,maximumDateParts:0},field:null,timer:null,init:function(){this.options.timestamp?this.options.dateFormat?this.options.timeFormat?"function"!==typeof moment?console.error("Moment.js not loaded."):(this.field=this.target||this.$target.get(0),this.timer=setInterval(this.updateTime.bind(this),1E3)):console.error("Time format missing."):console.error("Date format missing."):console.error("Timestamp is missing.")},updateTime:function(){let a=
1E3*Math.floor(Date.now()/1E3),b=1E3*this.options.timestamp;a<=b?this.handleCountDown(a,b):this.options.countUp?this.handleCoupUp(b,a):this.handleCountDownEnd(b)},handleCountDown:function(a,b){this.handleTimeStrOutput(this.getTimeStr(moment.duration(b-a,"milliseconds")))},handleCoupUp:function(a,b){this.handleTimeStrOutput(this.getTimeStr(moment.duration(b-a,"milliseconds")))},handleCountDownEnd:function(a){this.clearTimer();a=moment.unix(a/1E3);(a=this.getPhrase("date_x_at_time_y",{"{date}":a.formatPHP(this.options.dateFormat),
"{time}":a.formatPHP(this.options.timeFormat)}))?this.field.textContent=a:console.error("Unable to get full end date.")},handleTimeStrOutput:function(a){"string"===typeof a?this.field.textContent!==a&&(this.field.textContent=a):this.handleCountDownEnd(1E3*this.options.timestamp)},getTimeStr:function(a){let b=this,c=[],e=this.options.maximumDateParts;"year month day hour minute second".split(" ").forEach(d=>{e&&c.length>=e||(d=b.getDatePart(a,d),"string"!==typeof d?0<e&&0<c.length&&(e=c.length):c.push(d))});
return c.length?c.join(", "):null},getDatePart:function(a,b){if("string"!==typeof b)return console.error("Invalid date type provided.",b),!1;let c=b+"s";return"function"!==typeof a[c]?(console.error("Invalid date type provided.",b),!1):(a=parseInt(a[c]()))?this.getPhrase("svStandardLib_time."+b+(1<a?"s":""),{"{count}":a}):!1},getPhrase:function(a,b){b="object"===typeof b?b:{};if("string"!==typeof a||!a)return this.clearTimer(),console.error("Invalid phrase provided.",a),!1;if(!(a in XF.phrases))return this.clearTimer(),
console.error("Phrase is not available.",a),!1;b=XF.phrase(a,b,null);return null===b?(this.clearTimer(),console.error("Phrase translation failed.",a),!1):b},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null,this.triggerEventIfNeeded())},getEventTarget:function(){var a=this.options.triggerEventOnSelector;return a?this.$target?(a=XF.findRelativeIf(a,this.target||this.$target),0!==a.length?a.get(0):null):XF.findRelativeIf(a,this.target):null},triggerEventIfNeeded:function(){let a=
this.getEventTarget(),b=this.options.triggerEvent;a&&b&&("function"===typeof XF.trigger?XF.trigger(a,b):f(a).trigger(b))}});XF.Element.register("sv-standard-lib--relative-timestamp","SV.StandardLib.RelativeTimestamp")})();
