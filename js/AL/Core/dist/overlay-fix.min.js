"use strict";/**
 * Fixes the issue with XF toggle control triggering the submit event twice, once on the label once on the input
 */ // @ts-check
var AL=window.AL||{};/**
 * For the custom delay to work on any link, clicking which we immediately get a redirect response:
 * 1. message-with-delay key in the JSON response (used to stop the default message)
 * 2. data-force-flash-message="on" and data-follow-redirects="on" on the link
 * 3. Additional attribute on the link to define the length of message - data-message-timeout="3000"
 *
 * For the custom delay to work on a form, simply add data-redirect-timeout="3000"
 * to other data attributes of "ajax-submit" form
 */!function(a,b,c,d){return b(d).on("ajax-submit:response",function(c,d){var e=b(c.target),f=a.Element.getHandler(e,"ajax-submit"),g=e.closest(".overlay"),h=d.redirect&&f.options.redirect;f&&e.attr("data-redirect-timeout")&&"ok"===d.status&&h&&f.options.forceFlashMessage&&d.message&&(c.preventDefault(),a.flashMessage(d.message,e.attr("data-redirect-timeout"),function(){a.redirect(d.redirect)}))}),b(d).on("ajax:before-success",function(a,b){b&&"ok"===b.status&&b.message&&b.hasOwnProperty("message-with-delay")&&(b["message-with-timeout"]=b.message,b.message="")}),a.OverlayClick=a.extend(a.OverlayClick,{__backup:{show:"addonslabOverlayClickShow",init:"addonslabOverlayClickInit"},init:function init(){this.addonslabOverlayClickInit();var a=this.$target.data("messageTimeout");this.options.messageTimeout=a?parseInt(a):null},show:function show(){if(null===this.options.messageTimeout||this.overlay||this.loading||!this.options.followRedirects)return void this.addonslabOverlayClickShow();var b=this.options.messageTimeout;console.log("Delaying redirect for "+b+"ms"),this.loading=!0;var c,d=this,e={cache:this.options.cache,beforeShow:function beforeShow(a){d.overlay=a},init:a.proxy(this,"setupOverlay")};this.options.followRedirects&&(e.onRedirect=function(c){d.options.forceFlashMessage?a.flashMessage(c.message||c["message-with-timeout"],b,function(){a.redirect(c.redirect)}):a.redirect(c.redirect)}),c=a.loadOverlay(this.loadUrl,e,this.options.overlayConfig),c?c.always(function(){setTimeout(function(){d.loading=!1},300)}):this.loading=!1}}),!0;// @ts-ignore
}(window.XF,window.jQuery,window,document);
//# sourceMappingURL=overlay-fix.min.js.map