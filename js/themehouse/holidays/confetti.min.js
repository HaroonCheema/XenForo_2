!function(A,g,L,M){XF.THHolidaysConfetti=XF.Element.newHandler({init:function(){function I(a){var b=B();a=setTimeout(a,Math.max(0,16-(b-C)));C=b;return a}function d(a,b){this.x=a;this.y=b;this.Length=function(){return r(this.SqrLength())};this.SqrLength=function(){return this.x*this.x+this.y*this.y};this.Add=function(a){this.x+=a.x;this.y+=a.y};this.Sub=function(a){this.x-=a.x;this.y-=a.y};this.Div=function(a){this.x/=a;this.y/=a};this.Mul=function(a){this.x*=a;this.y*=a};this.Normalize=function(){var a=
this.SqrLength();0!=a&&(a=1/r(a),this.x*=a,this.y*=a)};this.Normalized=function(){var a=this.SqrLength();return 0!=a?(a=1/r(a),new d(this.x*a,this.y*a)):new d(0,0)}}function D(a,b,c,e){this.position=new d(a,b);this.mass=c;this.drag=e;this.force=new d(0,0);this.velocity=new d(0,0);this.AddForce=function(a){this.force.Add(a)};this.Integrate=function(a){var b=this.CurrentForce(this.position);b.Div(this.mass);var c=new d(this.velocity.x,this.velocity.y);c.Mul(a);this.position.Add(c);b.Mul(a);this.velocity.Add(b);
this.force=new d(0,0)};this.CurrentForce=function(a,b){a=new d(this.force.x,this.force.y);b=this.velocity.Length();var c=new d(this.velocity.x,this.velocity.y);c.Mul(this.drag*this.mass*b);a.Sub(c);return a}}function q(a,b){this.pos=new d(a,b);this.rotationSpeed=600*e()+800;this.angle=l*e()*360;this.rotation=l*e()*360;this.cosA=1;this.size=5;this.oscillationSpeed=1.5*e()+.5;this.xSpeed=40;this.ySpeed=60*e()+50;this.corners=[];this.time=e();a=w(e()*(h.length-1));this.frontColor=h[a][0];this.backColor=
h[a][1];for(a=0;4>a;a++){b=t(this.angle+l*(90*a+45));var f=E(this.angle+l*(90*a+45));this.corners[a]=new d(b,f)}this.Update=function(a){this.time+=a;this.rotation+=this.rotationSpeed*a;this.cosA=t(l*this.rotation);this.pos.x+=t(this.time*this.oscillationSpeed)*this.xSpeed*a;this.pos.y+=this.ySpeed*a;this.pos.y>q.bounds.y&&(this.pos.x=e()*q.bounds.x,this.pos.y=0)};this.Draw=function(a){a.fillStyle=0<this.cosA?this.frontColor:this.backColor;a.beginPath();a.moveTo((this.pos.x+this.corners[0].x*this.size)*
c,(this.pos.y+this.corners[0].y*this.size*this.cosA)*c);for(var b=1;4>b;b++)a.lineTo((this.pos.x+this.corners[b].x*this.size)*c,(this.pos.y+this.corners[b].y*this.size*this.cosA)*c);a.closePath();a.fill()}}function p(a,b,f,g,k,m,n,J){this.particleDist=g;this.particleCount=f;this.particleMass=n;this.particleDrag=J;this.particles=[];f=w(e()*(h.length-1));this.frontColor=h[f][0];this.backColor=h[f][1];this.xOff=t(l*m)*k;this.yOff=E(l*m)*k;this.position=new d(a,b);this.prevPosition=new d(a,b);this.velocityInherit=
2*e()+4;this.time=100*e();this.oscillationSpeed=2*e()+2;this.oscillationDistance=40*e()+40;this.ySpeed=40*e()+80;for(k=0;k<this.particleCount;k++)this.particles[k]=new D(a,b-k*this.particleDist,this.particleMass,this.particleDrag);this.Update=function(a){this.time+=a*this.oscillationSpeed;this.position.y+=this.ySpeed*a;this.position.x+=t(this.time)*this.oscillationDistance*a;this.particles[0].position=this.position;var b=this.prevPosition.x-this.position.x;var c=this.prevPosition.y-this.position.y;
c=r(b*b+c*c);this.prevPosition=new d(this.position.x,this.position.y);for(b=1;b<this.particleCount;b++){var x=d.Sub(this.particles[b-1].position,this.particles[b].position);x.Normalize();x.Mul(c/a*this.velocityInherit);this.particles[b].AddForce(x)}for(b=1;b<this.particleCount;b++)this.particles[b].Integrate(a);for(b=1;b<this.particleCount;b++)a=new d(this.particles[b].position.x,this.particles[b].position.y),a.Sub(this.particles[b-1].position),a.Normalize(),a.Mul(this.particleDist),a.Add(this.particles[b-
1].position),this.particles[b].position=a;this.position.y>p.bounds.y+this.particleDist*this.particleCount&&this.Reset()};this.Reset=function(){this.position.y=-e()*p.bounds.y;this.position.x=e()*p.bounds.x;this.prevPosition=new d(this.position.x,this.position.y);this.velocityInherit=2*e()+4;this.time=100*e();this.oscillationSpeed=2*e()+1.5;this.oscillationDistance=40*e()+40;this.ySpeed=40*e()+80;var a=w(e()*(h.length-1));this.frontColor=h[a][0];this.backColor=h[a][1];this.particles=[];for(a=0;a<this.particleCount;a++)this.particles[a]=
new D(this.position.x,this.position.y-a*this.particleDist,this.particleMass,this.particleDrag)};this.Draw=function(a){for(var b=0;b<this.particleCount-1;b++){var e=new d(this.particles[b].position.x+this.xOff,this.particles[b].position.y+this.yOff),f=new d(this.particles[b+1].position.x+this.xOff,this.particles[b+1].position.y+this.yOff);0>this.Side(this.particles[b].position.x,this.particles[b].position.y,this.particles[b+1].position.x,this.particles[b+1].position.y,f.x,f.y)?(a.fillStyle=this.frontColor,
a.strokeStyle=this.frontColor):(a.fillStyle=this.backColor,a.strokeStyle=this.backColor);0==b?(a.beginPath(),a.moveTo(this.particles[b].position.x*c,this.particles[b].position.y*c),a.lineTo(this.particles[b+1].position.x*c,this.particles[b+1].position.y*c),a.lineTo(.5*(this.particles[b+1].position.x+f.x)*c,.5*(this.particles[b+1].position.y+f.y)*c),a.closePath(),a.stroke(),a.fill(),a.beginPath(),a.moveTo(f.x*c,f.y*c),a.lineTo(e.x*c,e.y*c),a.lineTo(.5*(this.particles[b+1].position.x+f.x)*c,.5*(this.particles[b+
1].position.y+f.y)*c)):b==this.particleCount-2?(a.beginPath(),a.moveTo(this.particles[b].position.x*c,this.particles[b].position.y*c),a.lineTo(this.particles[b+1].position.x*c,this.particles[b+1].position.y*c),a.lineTo(.5*(this.particles[b].position.x+e.x)*c,.5*(this.particles[b].position.y+e.y)*c),a.closePath(),a.stroke(),a.fill(),a.beginPath(),a.moveTo(f.x*c,f.y*c),a.lineTo(e.x*c,e.y*c),a.lineTo(.5*(this.particles[b].position.x+e.x)*c,.5*(this.particles[b].position.y+e.y)*c)):(a.beginPath(),a.moveTo(this.particles[b].position.x*
c,this.particles[b].position.y*c),a.lineTo(this.particles[b+1].position.x*c,this.particles[b+1].position.y*c),a.lineTo(f.x*c,f.y*c),a.lineTo(e.x*c,e.y*c));a.closePath();a.stroke();a.fill()}};this.Side=function(a,b,c,d,e,f){return(a-c)*(f-d)-(b-d)*(e-c)}}var n={confettiCount:95,ribbonCount:30,confettiRibbonCount:11,speed:15};try{var v=A.parseJSON(A(".js-thHolidaysConfettiOptions").first().html())||{},y;for(y in v)n[y]=parseFloat(v[y])}catch(a){console.error(a)}var m=this.$target[0],c=g.devicePixelRatio;
v=Math.PI;var r=Math.sqrt,w=Math.round,e=Math.random,t=Math.cos,E=Math.sin,F=g.requestAnimationFrame,G=g.cancelAnimationFrame||g.cancelRequestAnimationFrame,B=Date.now||function(){return(new Date).getTime()},C=B(),K=g.cancelAnimationFrame||g.webkitCancelAnimationFrame||g.clearTimeout;F=g.requestAnimationFrame||g.webkitRequestAnimationFrame||I;G=function(a){K.call(g,a)};var H=1/(100-n.speed),l=v/180,h=[["#df0049","#660671"],["#00e857","#005291"],["#2bebbc","#05798a"],["#ffd200","#b06c00"]];d.Lerp=
function(a,b,c){return new d((b.x-a.x)*c+a.x,(b.y-a.y)*c+a.y)};d.Distance=function(a,b){return r(d.SqrDistance(a,b))};d.SqrDistance=function(a,b){var c=a.x-b.x;a=a.y-b.y;return c*c+a*a+z*z};d.Scale=function(a,b){return new d(a.x*b.x,a.y*b.y)};d.Min=function(a,b){return new d(Math.min(a.x,b.x),Math.min(a.y,b.y))};d.Max=function(a,b){return new d(Math.max(a.x,b.x),Math.max(a.y,b.y))};d.ClampMagnitude=function(a,b){a=a.Normalized;return new d(a.x*b,a.y*b)};d.Sub=function(a,b){return new d(a.x-b.x,a.y-
b.y,a.z-b.z)};q.bounds=new d(0,0);p.bounds=new d(0,0);u={Context:function(a){a=0;var b=m.parentNode,f=b.offsetWidth,g=b.offsetHeight;m.width=f*c;m.height=g*c;var k=m.getContext("2d"),h=[];p.bounds=new d(f,g);for(a=0;a<n.confettiRibbonCount;a++)h[a]=new p(e()*f,-e()*g*2,n.ribbonCount,8,8,45,1,.05);var l=[];q.bounds=new d(f,g);for(a=0;a<n.confettiCount;a++)l[a]=new q(e()*f,e()*g);this.resize=function(){f=b.offsetWidth;g=b.offsetHeight;m.width=f*c;m.height=g*c;q.bounds=new d(f,g);p.bounds=new d(f,g)};
this.start=function(){this.stop();this.update()};this.stop=function(){G(this.interval)};this.update=function(){var a=0;k.clearRect(0,0,m.width,m.height);for(a=0;a<n.confettiCount;a++)l[a].Update(H),l[a].Draw(k);for(a=0;a<n.confettiRibbonCount;a++)h[a].Update(H),h[a].Draw(k);this.interval=F(function(){u.update()})}}};var u=new u.Context("confetti");u.start();g.addEventListener("resize",function(a){u.resize()})}});XF.Element.register("th-holidays-confetti","XF.THHolidaysConfetti")}(jQuery,window,document);
