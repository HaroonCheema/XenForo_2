<xf:title page="{$page}">{{ phrase('fs_quiz') }}</xf:title>

<script>
	// For All Auctions
	function DateTimeConverter(unixdatetime) {
		var wStart_time = new Date(unixdatetime * 1000).toLocaleString("en-US", {
			hour12: false,
			//  timeZone: 'America/New_York',
			// timeZone:'Europe/London',
			timeStyle: "long",
		});
		var clientTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
		var tempHumanDate = new Date(unixdatetime * 1000).toLocaleDateString(
			"en-US",
			{
				timeZone: clientTimezone,
				// timeZone: "Asia/Tashkent",
				// timeZone: "America/New_York",
				year: "numeric",
				month: "numeric",
				day: "numeric",
			}
		);

		var humanDate = new Date(tempHumanDate);
		var year = humanDate.getFullYear();
		var month = (humanDate.getMonth() + 1).toString().padStart(2, "0");
		var date = humanDate.getDate();

		var fulldate = year + "-" + month + "-" + date + " " + wStart_time + ":00";

		// FormatingDateEspecialyForIOS
		var tempCountTimmer = fulldate.split(/[- :]/);
		// Apply each element to the Date function
		var tempDateObject = new Date(
			tempCountTimmer[0],
			tempCountTimmer[1] - 1,
			tempCountTimmer[2],
			tempCountTimmer[3],
			tempCountTimmer[4],
			tempCountTimmer[5]
		);
		var CountDownDateTime = new Date(tempDateObject).getTime();

		return CountDownDateTime;
	}

	function timmerCounter(auction_id, start_datetime) {
		let auc_id = auction_id;

		let humanDateTime = DateTimeConverter(start_datetime);

		var countDownDate = new Date(humanDateTime).getTime();
		var counter = setInterval(function () {
			// Get today's date and time
			var now = new Date().getTime();
			// Find the distance between now and the count down date
			var timeDistance = countDownDate - now;
			document.getElementById("days-quiz-" + auc_id).innerHTML =
				Math.floor(timeDistance / (1000 * 60 * 60 * 24)) + " D";
			document.getElementById("hours-quiz-" + auc_id).innerHTML =
				Math.floor((timeDistance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)) +
				" H";
			document.getElementById("minutes-quiz-" + auc_id).innerHTML =
				Math.floor((timeDistance % (1000 * 60 * 60)) / (1000 * 60)) + " M";
			document.getElementById("seconds-quiz-" + auc_id).innerHTML =
				Math.floor((timeDistance % (1000 * 60)) / 1000) + " S";

			// If the count down is over, write some text
			if (timeDistance < 0) {
				clearInterval(counter);
				document.getElementById("quiz-counter-" + auc_id).style.display =
					"none";
			}
		}, 1000);
	}
</script>


<xf:page
		 option="searchConstraints"
		 value="{{ {
				phrase('fs_auction_auctions'): {'search_type': 'fs_auction_auctions'}
				} }}"
		 />

<xf:if is="$canInlineMod">
	<xf:js src="xf/inline_mod.js" min="1" />
</xf:if>

<div
	 class="block"
	 data-xf-init="{{ $canInlineMod ? 'inline-mod' : '' }}"
	 data-type="fs_quiz_list"
	 data-href="{{ link('inline-mod') }}"
	 >
	<div class="block-outer">
		<xf:trim>
			<xf:pagenav
						page="{$page}"
						perpage="{$perPage}"
						total="{$total}"
						link="quiz"
						params="{$filters}"
						wrapperclass="block-outer-main"
						/>

		</xf:trim>
	</div>
	<div class="block-container">
		<xf:macro name="search_menu" arg-conditions="{$conditions}" />

		<!--Listing View--->
		<div class="block-body">
			<xf:if is="$listings is not empty">
				<div class="structItemContainer">
					<xf:foreach loop="$listings" value="$listing">
						<xf:macro
								  template="fs_quiz_list_macros"
								  name="listing"
								  arg-listing="{$listing}"
								  />
					</xf:foreach>
				</div>
				<xf:elseif is="$filters" />
				<div class="block-row">
					{{ phrase('fs_quiz_there_no_matching_your_filters') }}
				</div>
				<xf:else />
				<div class="block-row">
					{{ phrase('fs_quiz_no_quiz_have_been_created_yet') }}
				</div>
			</xf:if>

			<div class="block-footer">
				<span class="block-footer-counter"
					  >{{ display_totals($totalReturn, $total) }}</span
					>
			</div>
		</div>
	</div>

	<div class="block-outer block-outer--after">
		<xf:pagenav
					page="{$page}"
					perpage="{$perPage}"
					total="{$total}"
					link="quiz"
					params="{$filters}"
					wrapperclass="block-outer-main"
					/>
		<xf:showignored wrapperclass="block-outer-opposite" />
	</div>
</div>

<xf:page option="sideNavTitle">{{ phrase('categories') }}</xf:page>

<xf:sidenav>
	<xf:macro
			  template="fs_quiz_category_list_macros"
			  name="simple_list_block"
			  arg-categoryTree="{$categoryTree}"
			  />
</xf:sidenav>

<!-- Filter Bar Macro Start -->

<xf:macro name="search_menu" arg-conditions="!">
	<div class="block-filterBar">
		<div class="filterBar">
			<a
			   class="filterBar-menuTrigger"
			   data-xf-click="menu"
			   role="button"
			   tabindex="0"
			   aria-expanded="false"
			   aria-haspopup="true"
			   >{{ phrase('filters') }}</a
				>
			<div
				 class="menu menu--wide"
				 data-menu="menu"
				 aria-hidden="true"
				 data-href="{{ link('quiz/refine-search', null, $conditions)}}"
				 data-load-target=".js-filterMenuBody"
				 >
				<div class="menu-content">
					<h4 class="menu-header">{{ phrase('show_only:') }}</h4>
					<div class="js-filterMenuBody">
						<div class="menu-row">{{ phrase('loading...') }}</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</xf:macro>