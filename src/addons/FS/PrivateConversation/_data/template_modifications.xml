<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="post_macros" modification_key="fs_private_conversation_post_macros" description="fs_private_conversation_post_macros" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:if is="$hasActionBarMenu">]]></find>
    <replace><![CDATA[<xf:if is="!in_array($thread.node_id, $xf.options.fsPrivateConversationExcludeForums)">
	<xf:if is="$post.User AND $xf.visitor.canStartConversationWith($post.User)">
		<xf:set var="$hasActionBarMenu" value="{{ true }}" />
		<a href="{{ link('conversations/start-conversation', '', {'to': $post.username, 'title': $post.Thread.title, 'post_id': $post.post_id}) }}" class="actionBar-action actionBar-action--fsStartConversation">{{ phrase('fsPrivateConversation_start_conversation') }}</a>
		<xf:set var="$hasActionBarMenu" value="{{ true }}" />
		<a href="{{ link('conversations/start-conversation', '', {'to': $post.username, 'title': $post.Thread.title, 'post_id': $post.post_id}) }}" class="actionBar-action actionBar-action--fsPrivateMessage">{{ phrase('fsPrivateConversation_private_message') }}</a>
	</xf:if>
</xf:if>

<style>

	.actionBar-action.actionBar-action--fsPrivateMessage {
		display: none;
	}

	@media (max-width: 480px) {
		.actionBar-action.actionBar-action--fsStartConversation {
			display: none !important;
		}

		.actionBar-action.actionBar-action--fsPrivateMessage {
			display: inline-block !important;
		}
	}

</style>
$0]]></replace>
  </modification>
</template_modifications>
