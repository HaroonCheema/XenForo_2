<xf:macro name="item"
	arg-post="!"
	arg-forum=""
	arg-forceRead="{{ false }}"
	arg-showWatched="{{ true }}"
	arg-allowInlineMod="{{ true }}"
	arg-chooseName=""
     arg-thread = ""
	arg-extraInfo=""
	arg-allowEdit="{{ true }}"	  
		  >

	<xf:css src="structured_list.less" />

	<div class="structItem structItem--thread{{ $post.Thread.prefix_id ? ' is-prefix' . $post.Thread.prefix_id : '' }}{{ $post.Thread.isIgnored() ? ' is-ignored' : '' }}{{ ($post.Thread.isUnread()) ? ' is-unread' : '' }}{{ $post.Thread.discussion_state == 'moderated' ? ' is-moderated' : '' }}{{ $post.Thread.discussion_state == 'deleted' ? ' is-deleted' : '' }} js-inlineModContainer js-threadListItem-{$post.Thread.thread_id}" data-author="{{ $post.Thread.User.username ?: $post.Thread.username }}">

	
		<div class="structItem-cell structItem-cell--icon">
			<div class="structItem-iconContainer">
				<xf:avatar user="$post.Thread.User" size="s" defaultname="{$post.Thread.username}" />
				
			</div>
		</div>



		<div class="structItem-cell structItem-cell--main" data-xf-init="touch-proxy">

			<div class="structItem-title">

				
		<xf:comment>
			<xf:if is="$allowInlineMod AND $post.canUseInlineModeration()" >
				<xf:checkbox standalone="true" class="js-inlineModToggle">
					<xf:option value="{$post.post_id}" class="js-inlineModToggle"
							   data-xf-init="tooltip"
							   title="{{ phrase('select_for_moderation') }}"
							   label="{{ phrase('select_for_moderation') }}"
							   hiddenlabel="true" />
				</xf:checkbox>
			</xf:if>
		</xf:comment>
		
				
				
				
				<xf:set var="$canPreview" value="{{ $post.Thread.canPreview() }}" />
				<xf:if is="$post.Thread.prefix_id">
					<xf:if is="$forum">
						<a href="{{ link('forums', $forum, {'prefix_id': $post.Thread.prefix_id}) }}" class="labelLink" rel="nofollow">{{ prefix('thread', $thread, 'html', '') }}</a>
					<xf:else />
						{{ prefix('thread', $thread, 'html', '') }}
					</xf:if>
				</xf:if>
				<a href="{{ link('posts/', $post) }}" class="" data-tp-primary="on" data-xf-init="{{ $canPreview ? 'preview-tooltip' : '' }}" data-preview-url="{{ $canPreview ? link('threads/preview', $post.Thread) : '' }}">{$post.Thread.title}</a> - <a href="{{ link('forums/', $post.Thread.Forum) }}" class="" data-tp-primary="on" data-xf-init="{{ $canPreview ? 'preview-tooltip' : '' }}" >{$post.Thread.Forum.title}</a>
			</div>

			<div class="structItem-minor">

					<ul class="structItem-parts">
							<li><p >
								
								<xf:if is="$xf.visitor.is_admin">
									{{ snippet($post.message, $xf.options.xb_number_of_characters,{'stripQuote': true}) }}	
								<xf:else />
									{{ bb_code($post.message, 'post', $post) }}
								</xf:if>		
							
								</p>
						
						</li>
					</ul>

					
			
			</div>
		</div>

		<div class="structItem-cell structItem-cell--latest">
			<xf:if is="$post.Thread.discussion_type == 'redirect'">
				{{ phrase('n_a') }}
			<xf:else />
				<a href="#" rel="nofollow"
				   >
					<xf:if is="$xf.visitor.isIgnoring($post.user_id)">
						{{ phrase('ignored_member') }}
					<xf:else />
						<xf:avatar user="{$post.User}" defaultname="{$post.username}" size="xxs" />
						<xf:username user="{$post.User}" defaultname="{$post.username}" />
					</xf:if>
					
					
					
				</a>
				<div class="structItem-minor">
					<xf:date time="{$post.Thread.last_post_date}" class="structItem-latestDate" />
				</div>
			</xf:if>
		</div>

	

	</div>
</xf:macro>

<xf:macro name="item_new_posts" arg-thread="!">
	<div class="contentRow">
		<div class="contentRow-figure">
			<xf:avatar user="$post.Thread.LastPoster" size="xxs" defaultname="{$post.Thread.last_post_username}" />
		</div>
		<div class="contentRow-main contentRow-main--close">
			<xf:if is="$post.Thread.isUnread()">
				<a href="{{ link('threads/unread', $thread) }}">{{ prefix('thread', $thread) }}{$post.Thread.title}</a>
			<xf:else />
				<a href="{{ link('threads/post', $thread, {'post_id': $post.Thread.last_post_id}) }}">{{ prefix('thread', $thread) }}{$post.Thread.title}</a>
			</xf:if>

			<div class="contentRow-minor contentRow-minor--hideLinks">
				<ul class="listInline listInline--bullet">
					<li>{{ phrase('latest_x', {'name': $post.Thread.last_post_cache.username}) }}</li>
					<li><xf:date time="{$post.Thread.last_post_date}" /></li>
				</ul>
			</div>
			<div class="contentRow-minor contentRow-minor--hideLinks">
				<a href="{{ link('forums', $post.Thread.Forum) }}">{$post.Thread.Forum.title}</a>
			</div>
		</div>
	</div>
</xf:macro>

<xf:macro name="item_new_threads" arg-thread="!">
	<div class="contentRow">
		<div class="contentRow-figure">
			<xf:avatar user="$post.Thread.User" size="xxs" defaultname="{$post.Thread.username}" />
		</div>
		<div class="contentRow-main contentRow-main--close">
			<a href="{{ link('threads', $thread) }}">{{ prefix('thread', $thread) }}{$post.Thread.title}</a>

			<div class="contentRow-minor contentRow-minor--hideLinks">
				<ul class="listInline listInline--bullet">
					<li>{{ phrase('started_by_x', {'name': $post.Thread.username}) }}</li>
					<li><xf:date time="{$post.Thread.post_date}" /></li>
					<li>{{ phrase('replies:') }} {$post.Thread.reply_count|number_short}</li>
				</ul>
			</div>
			<div class="contentRow-minor contentRow-minor--hideLinks">
				<a href="{{ link('forums', $post.Thread.Forum) }}">{$post.Thread.Forum.title}</a>
			</div>
		</div>
	</div>
</xf:macro>

<xf:macro name="quick_thread"
	arg-forum="!"
	arg-page="1"
	arg-order="last_post_date"
	arg-direction="desc"
	arg-prefixes="{{ [] }}">

	<xf:css src="structured_list.less" />

	<xf:if is="$forum.canCreateThread() OR $forum.canCreateThreadPreReg()">

		<xf:js src="xf/thread.js" min="1" />

		<xf:set var="$inlineMode" value="{{ ($page == 1 && $order == 'last_post_date' && $direction == 'desc') ? true : false }}" />

		<xf:form action="{{ link('forums/post-thread', $forum, {'inline-mode': $inlineMode}) }}" class="structItem" ajax="true"
			draft="{{ link('forums/draft', $forum) }}"
			data-xf-init="quick-thread"
			data-focus-activate=".js-titleInput"
			data-focus-activate-href="{{ link('forums/post-thread', $forum, {'inline-mode': true}) }}"
			data-focus-activate-target=".js-quickThreadFields"
			data-insert-target=".js-threadList"
			data-replace-target=".js-emptyThreadList">

	
			<div class="structItem-cell structItem-cell--icon">
				<div class="structItem-iconContainer">
					<xf:avatar user="$xf.visitor" size="s" />
				</div>
			</div>
	


			<div class="structItem-cell structItem-cell--newThread js-prefixListenContainer">

				<xf:formrow rowtype="noGutter noLabel fullWidth noPadding mergeNext"
					label="{{ phrase('title') }}">

					<xf:prefixinput maxlength="{{ max_length('XF:Thread', 'title') }}"
						placeholder="{$forum.thread_prompt}"
						title="{{ phrase('post_new_thread_in_this_forum') }}"
						prefix-value="{$forum.default_prefix_id}"
						type="thread"
						prefixes="{$prefixes}"
						data-xf-init="tooltip"
						rows="1"
						help-href="{{ link('forums/prefix-help', $forum) }}"
						help-skip-initial="{{ true }}" />
				</xf:formrow>

				<div class="js-quickThreadFields inserter-container is-hidden"><!--{{ phrase('loading...') }}--></div>
			</div>


		</xf:form>
	</xf:if>

</xf:macro>