<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="PAGE_CONTAINER" modification_key="fs_ban_user_PAGE_CONTAINER_list" description="fs_ban_user_PAGE_CONTAINER_list" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:if is="\$xf\.visitor\.is_admin">.*?<\/xf:if>/is]]></find>
    <replace><![CDATA[$0

<xf:if is="$xf.visitor.is_admin || $xf.visitor.is_moderator">
	<a href="{{ link('banned-users') }}" class="p-staffBar-link" >{{ phrase('fs_ban_banned_users') }}</a>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="PAGE_CONTAINER" modification_key="fs_banned_users_hide_conversation_box" description="fs_banned_users_hide_conversation_box" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<a href="{{ link\('conversations'\) }}".*?<\/a>/is]]></find>
    <replace><![CDATA[<xf:if is="!$xf.visitor.is_banned">$0</xf:if>]]></replace>
  </modification>
  <modification type="public" template="forum_list" modification_key="fs_ban_user_forum_list_for_banned" description="fs_ban_user_forum_list_for_banned" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:if is="\$xf\.options\.forumsDefaultPage != 'forums' OR \(\$xf\.options\.indexRoute AND \$xf\.options\.indexRoute != 'forums\/'\)">.*?<\/div>
		<\/div>
	<\/xf:if>
<\/xf:macro>/is]]></find>
    <replace><![CDATA[<xf:if is="$xf.visitor.is_banned">
	<xf:include template="fs_ban_forum_list" />
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="forum_view" modification_key="fs_ban_user_forum_view_for_banned" description="fs_ban_user_forum_view_for_banned" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:title page="{\$page}">{\$forum\.Node\.title}<\/xf:title>.*?<\/a>
		<\/div>
	<\/div>
<\/xf:macro>/is]]></find>
    <replace><![CDATA[<xf:if is="$xf.visitor.is_banned">
	<xf:include template="fs_ban_forum_view" />
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_about" modification_key="fs_ban_member_about_add_details" description="fs_ban_member_about_add_details" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="block">
	<div class="block-container">
		<div class="block-body">.*?<\/div>
	<\/div>
<\/div>/is]]></find>
    <replace><![CDATA[<xf:if is="$user.is_banned AND !$xf.visitor.hasPermission('fs_ban_watch_profile', 'other_can_check')">
	<div class="block">
		<div class="block-container">
			<div class="block-body">
				<div class="block-row block-row--separated">
					<dl class="pairs pairs--columns pairs--fixedSmall">
						<dt>{{ phrase('fs_ban_issued_by') }}</dt>
						<dd>
							{{$user.Ban.BanUser.username}}
						</dd>

					</dl>
					<dl class="pairs pairs--columns pairs--fixedSmall">
						<dt>{{ phrase('fs_ban_ban_date') }}</dt>
						<dd>
							<xf:date time="{$user.Ban.ban_date}" />
						</dd>

					</dl>
					<dl class="pairs pairs--columns pairs--fixedSmall">
						<dt>{{ phrase('fs_ban_end_date') }}</dt>
						<dd>
							<xf:if is="$user.Ban.end_date">
								<xf:date time="{$user.Ban.end_date}" />
								<xf:else/>
								{{ phrase('permanent') }}
							</xf:if>

						</dd>

					</dl>
					<dl class="pairs pairs--columns pairs--fixedSmall">
						<dt>{{ phrase('fs_ban_reason') }}</dt>
						<dd>
							{$user.Ban.user_reason}
						</dd>
					</dl>
				</div>
			</div>
		</div>
	</div>
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="fs_ban_user_hide_all_tab_panes" description="fs_ban_user_hide_all_tab_panes" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<ul class="tabPanes js-memberTabPanes">.*?<!--\[XF:tab_panes:end]-->
<\/ul>/is]]></find>
    <replace><![CDATA[<xf:if is="$user.is_banned AND !$xf.visitor.hasPermission('fs_ban_watch_profile', 'other_can_check')">
	<ul class="tabPanes js-memberTabPanes banUserHideTabs">

		<li class="banUserHideTabs" data-href="{{ link('members/about', $user) }}" role="tabpanel" aria-labelledby="about">
			<div class="blockMessage">{{ phrase('loading...') }}</div>
		</li>

	</ul>
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="fs_ban_user_hide_all_tabs" description="fs_ban_user_hide_all_tabs" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<span class="hScroller-scroll">.*?<\/span>/is]]></find>
    <replace><![CDATA[<xf:if is="$user.is_banned AND !$xf.visitor.hasPermission('fs_ban_watch_profile', 'other_can_check')">
	<span class="hScroller-scroll banUserHideTabs">

		<a href="{{ link('members/about', $user) }}"
		   class="tabs-tab banUserHideTabs"
		   id="about"
		   role="tab">{{ phrase('about') }}</a>

	</span>
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
</template_modifications>
