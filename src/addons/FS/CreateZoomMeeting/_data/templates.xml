<?xml version="1.0" encoding="utf-8"?>
<templates>
  <template type="admin" title="fs_edit_zoom_meeting" version_id="1000010" version_string="1.0.0 Alpha"><![CDATA[<xf:if is="$meeting.isInsert()">
	<xf:title>{{ phrase('add_meeting') }}</xf:title>
	<xf:else />
	<xf:title>{{ phrase('edit_meeting:') }} {$meeting.topic}</xf:title>
</xf:if>

<xf:pageaction if="$meeting.isUpdate()">
	<xf:button href="{{ link('meeting/delete', $meeting) }}" icon="delete" overlay="true" />
</xf:pageaction>

<xf:form action="{{ link('meeting/save', $meeting) }}"  ajax="true" data-xf-init="attachment-manager" >

	<div class="block-container">
		<div class="block-body">

			<xf:textboxrow name="topic" value="{$meeting.topic}"  required="true" autofocus="true"
						   label="{{ phrase('zoom_meeting_topic') }}" />

			<xf:editorrow name="description" value="{{$meeting.Thread ? $meeting.Thread.FirstPost.message : ''}}" 
						  label="{{ phrase('zoom_meeting_description') }}" />



			<h2 class="block-formSectionHeader"><span class="block-formSectionHeader-aligner">{{phrase('meeting_timing')}}</span></h2>
			<xf:formrow rowtype="input"
						label="{{ phrase('start_time') }}">
				<div class="inputGroup">

					<xf:dateinput name="start_date" class="date start" value="{{$meeting.start_time ? $meeting.start_time : ''}}" required="true"
								  hint="{{ phrase('required') }}"/>

					<span class="inputGroup-splitter"></span>

					<xf:textbox name="start_time" class="input--date time start" required="true" type="time"
								value="{{$meeting.start_time ? $meeting.getStartTimeConvert() : ''}}"
								data-xf-init="time-picker" data-moment="{{$meeting.start_time ? $meeting.getStartTimeConvert() : ''}}" data-format="{{ $xf.language.time_format }}" />

				</div>
			</xf:formrow>

			<xf:numberboxrow name="duration" value="{{$meeting.duration}}" min="10" 			
							 label="{{ phrase('duration') }}"  explain="{{phrase('duration_explain')}}"/>

			<h2 class="block-formSectionHeader"><span class="block-formSectionHeader-aligner">{{phrase('meeting_discussion')}}</span></h2>

			<xf:textboxrow name="thread_title" value="{$meeting.Thread.title}"  required="true" autofocus="true"
						   label="{{ phrase('discussion_title') }}" explain="{{ phrase('discussion_title_explain') }}" />

			<xf:formrow label="{{phrase('destination_forum')}}">

				<xf:select name="forum_id" value="{$meeting.forum_id}" id="js-applicableForums">

					<xf:foreach loop="$nodeTree.getFlattened(0)" value="$treeEntry">
						<xf:option value="{$treeEntry.record.node_id}"
								   disabled="{{ $treeEntry.record.node_type_id != 'Forum' }}"
								   label="{{ repeat('&nbsp;&nbsp;', $treeEntry.depth)|raw }} {$treeEntry.record.title}" />
					</xf:foreach>

				</xf:select>
			</xf:formrow>
			<h2 class="block-formSectionHeader"><span class="block-formSectionHeader-aligner">{{phrase('join_meeting_validation')}}</span></h2>
			<xf:selectrow name="join_usergroup_ids[]" multiple="multiple" size="5" value="{{$meeting.join_usergroup_ids}}"
						  label="{{ phrase('user_groups_allow_join') }}"
						  explain="{{ phrase('user_groups_allow_join_explain') }}"
						  >
				<xf:foreach loop="$userGroups" value="$userGroup">
					<xf:option value="{$userGroup.user_group_id}">{$userGroup.title}</xf:option>
				</xf:foreach>
			</xf:selectrow>
			<xf:comment>
				<h2 class="block-formSectionHeader"><span class="block-formSectionHeader-aligner">{{phrase('alert_before_meeting_start')}}</span></h2>
				<xf:numberboxrow name="alert_duration" value="{{$meeting.alert_duration}}" min="1" 			
								 label="{{ phrase('alert_send') }}"  explain="{{phrase('alert_send_explain')}}"/>
			</xf:comment>
		</div>
	</div>
	<xf:submitrow sticky="true" icon="save" />

</xf:form>]]></template>
  <template type="admin" title="fs_option_template_zoomadvance" version_id="1000010" version_string="1.0.0 Alpha"><![CDATA[<xf:formrow
	label="{$option.title}"
	hint="{$hintHtml}"
	explain="{$explainHtml}"
	rowclass="{$rowClass}">

	<div>{{ phrase('fs_built_zoom_auth_system') }}</div>
	<div class="u-inputSpacer">
		<xf:button href="{{ link('options/zoom-meeting-auth-setup', $option) }}" data-xf-click="overlay">
			{{ phrase('change') }}
		</xf:button>
	</div>
</xf:formrow>]]></template>
  <template type="admin" title="fs_option_zoom_transport_auth" version_id="1000010" version_string="1.0.0 Alpha"><![CDATA[<xf:title>{$option.title}</xf:title>

<xf:form action="{{ link('options/zoom-meeting-auth-setup', $option) }}"  class="block">
	<div class="block-container">
		<div class="block-body">
			<xf:inforow>
				{{ phrase('zoom_setup_explain:') }}
				<div><code>{$redirectUri}</code></div>
			</xf:inforow>

			<xf:textboxrow name="client_id" value="{$xf.options.zoom_meeting_client_id}"
				label="{{ phrase('client_id') }}"
				required="required" />

			<xf:textboxrow name="client_secret"
						   value="{$xf.options.zoom_meeting_client_secret}"
				label="{{ phrase('client_secret') }}"
				required="required" />

			<xf:inforow>
				{{ phrase('continuing_will_redirect_you_to_zoom_to_confirm_account_you_want_to') }}
			</xf:inforow>
		</div>
		<xf:submitrow sticky="true" submit="{{ phrase('continue') }}" />
	</div>
</xf:form>]]></template>
  <template type="admin" title="fs_zoom_meetings" version_id="1000010" version_string="1.0.0 Alpha"><![CDATA[<xf:title>{{ phrase('meeting_list') }}</xf:title>

<xf:if is="!count($meetings)">
	<xf:pageaction>
		<xf:button href="{{ link('meeting/add') }}" icon="user">{{ phrase('add_meeting') }}</xf:button>
	</xf:pageaction>
</xf:if>

<xf:if is="$meetings is not empty">
	<xf:form action="{{ link('meeting/toggle') }}" class="block" ajax="true">
		<div class="block-outer">
			<xf:macro template="filter_macros" name="quick_filter" arg-key="meetings" arg-class="block-outer-opposite" />
		</div>
		<div class="block-container">
			<div class="block-body">

				<xf:datalist data-xf-init="responsive-data-list">
					<xf:datarow rowtype="header">
						<xf:cell>{{ phrase('zoom_topic') }}</xf:cell>
						<xf:cell>{{ phrase('start_date') }}</xf:cell>
						<xf:cell>{{ phrase('start_time') }}</xf:cell>
						<xf:cell>{{ phrase('duration') }}</xf:cell>
						<xf:cell>{{ phrase('start_url') }}</xf:cell>
						<xf:cell>{{ phrase('join_url') }}</xf:cell>
						<xf:cell>{{ phrase('disucssion') }}</xf:cell>
						<xf:cell class="dataList-cell--min">&nbsp;</xf:cell>
						<xf:comment><xf:cell class="dataList-cell--min">&nbsp;</xf:cell></xf:comment>
					</xf:datarow>
					<xf:foreach loop="$meetings" value="$meeting">
						<xf:datarow>
							<xf:cell>{$meeting.topic}</xf:cell>
							<xf:cell>{$meeting.getStartDate()}</xf:cell>
							<xf:cell>{$meeting.getStartTime()}</xf:cell>
							<xf:cell>{$meeting.duration} mints</xf:cell>
							<xf:cell><xf:macro name="copy_key" arg-url="{{$meeting.z_start_url}}" arg-success="start url successfully copy." arg-targclass="js-startUrl{{$meeting.meetingId}}"/></xf:cell>
							<xf:cell><xf:macro name="copy_key" arg-url="{{$meeting.z_join_url}}" arg-success="Join url successfully copy." arg-targclass="js-joinUrl{{$meeting.meetingId}}"/></xf:cell>
							<xf:cell>
								<xf:if is="$meeting.Thread">
									<a href="{{ link_type('public', 'threads',$meeting.Thread) }}" target="_blank">{{$meeting.Thread.title}}</a>
									<xf:else/>
									0
								</xf:if>
							</xf:cell>							
							<xf:action href="{{ link('meeting/edit', $meeting) }}">{{ phrase('edit') }}</xf:action>
							<xf:comment><xf:delete href="{{ link('meeting/delete', $meeting) }}" /></xf:comment>
						</xf:datarow>
					</xf:foreach>
				</xf:datalist>
			</div>
			<div class="block-footer">
				<span class="block-footer-counter">{{ display_totals($meetings, $total) }}</span>
			</div>
		</div>
	</xf:form>
	<xf:else />
	<div class="blockMessage">{{ phrase('no_results_found') }}</div>
</xf:if>


<xf:pagenav page="{$page}" perpage="{$perPage}" total="{$total}"
			link="meeting" params="{$filters}"
			wrapperclass="block-outer block-outer--after" />

<xf:macro name="copy_key" arg-url="!" arg-success="!" arg-targclass="">
	<code class="{{$targclass}}" style="display:none;">{$url}</code>
	<xf:button icon="copy"
			   data-xf-init="copy-to-clipboard"
			   data-copy-target=".{{$targclass}}"
			   data-success="{{$success}}"
			   class="button--link is-hidden" />
</xf:macro>]]></template>
</templates>
