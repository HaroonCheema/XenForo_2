<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="extra.less" modification_key="whatupcall" description="Whats call" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/$/]]></find>
    <replace><![CDATA[{{ include('whatsup_call.less') }}]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="remove_touch_proxy" description="Remove Touch proxy for whatsup" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[touch-proxy]]></find>
    <replace><![CDATA[{{ in_array($thread.node_id,$xf.options.enabled_whatsup_forums) ? '' : 'touch-proxy'}}]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="whats_after_title" description="Display whats after title only in forum view template" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="structItem-title">.*?<\/div>/s]]></find>
    <replace><![CDATA[$0
<xf:if is="in_array($thread.node_id,$xf.options.enabled_whatsup_forums) && $xf.visitor.canShowCallWhatsup()">
	<xf:include template="call_whatsup"/>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="thread_view" modification_key="after_content_button" description="After content display whatsup button" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:macro id="thread_status" arg-thread="{$thread}" arg-wrapperClass="block-outer block-outer--after" />]]></find>
    <replace><![CDATA[<xf:if is="in_array($thread.node_id,$xf.options.enabled_whatsup_forums) && $xf.visitor.canShowCallWhatsup()">
	<xf:include template="call_whatsup"/>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="thread_view" modification_key="call_whatsup" description="before the content" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:set var="$threadActionsHtml">]]></find>
    <replace><![CDATA[<xf:if is="in_array($thread.node_id,$xf.options.enabled_whatsup_forums) && $xf.visitor.canShowCallWhatsup()">
<xf:include template="call_whatsup"/>
</xf:if>
$0]]></replace>
  </modification>
</template_modifications>
